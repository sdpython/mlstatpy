\input{../../common/livre_begin.tex}
\firstpassagedo{\input{squelette_titre.tex}}
\input{../../common/livre_table_begin.tex}
\firstpassagedo{\input{squelette_chapter.tex}}

\sloppy

\label{annexe_squelettisation}


\indexfrr{homotope}{squelette}
La squelettisation est une op�ration qui permet de passer d'une image aux traits �pais � une repr�sentation en "fil de fer" dont la premi�re apparition date de \citeindex{Blum1967}. La figure~\ref{squelette_fig2} repr�sente � la fois l'image initiale et le r�sultat obtenu en filigrane. Cette repr�sentation "fil de fer" est appel�e \emph{squelette}. Il n'existe pas de d�finition unique du squelette, il doit seulement respecter la connexit� de la forme qu'il est cens� repr�senter ou plus pr�cis�ment, une forme et son squelette doivent �tre \emph{homotopes}. Pour une composante connexe, le squelette correspondant ne forme �galement qu'une seule composante connexe incluse dans la premi�re. 



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=5cm, width=6.5cm]
        {\filext{../squelette/image/ske_example}}\end{array}$}$$
        \caption{Squelettisation d'une figure quelconque}
        \label{squelette_fig2}
            \end{figure}

L'article \citeindex{Lam1992} propose une revue des algorithmes de squelettisation. Ce chapitre pr�sente quelques-unes des m�thodes qui y sont pr�sent�es comme la squelettisation par �rosion (voir paragraphe~\ref{ske_par_erosion}), ainsi que d'autres issues d'articles plus r�cents et mieux adapt�es � la reconnaissance de l'�criture comme la mod�lisation des intersections (voir paragraphe~\ref{squelette_modelisation_intersection_modele}).









%------------------------------------------------------------------------------------------------------------
\section{Squelette d'une forme continue}
%------------------------------------------------------------------------------------------------------------
\indexfr{boule maximale}
\indexfrr{squelette}{continu}
\indexfrr{forme}{continue}

On se place ici dans le plan $\mathbb{R}^2$ et on consid�re une partie $F$ du plan qu'on appellera par la suite \emph{forme continue}. C'est en g�n�ral une partie connexe d'int�rieur non vide. L'objectif est ici de d�finir le squelette de cette forme, c'est-�-dire une partie d'int�rieur vide la repr�sentant le mieux possible. On d�finit une boule comme un disque de rayon strictement positif du plan. Les d�finitions qui suivent restent valables pour des espaces de dimension sup�rieure � deux (voir \citeindex{Blum1973}, \citeindex{Thiel1994}).

        \begin{xdefinition}{boule maximale}
        \indexfr{boule maximale}
        \label{ske_def_boule_max}
        
        Soit $F$ une forme continue, on note $\mathcal{B}_F$ l'ensemble des boules incluses dans $F$. 
        Une boule $B$ est dite maximale si et seulement si~:
        
                        $$
                        B \text{ est maximale } \Longleftrightarrow \forall B' \in \mathcal{B}_F, 
                        \; B \subset B' \Longrightarrow B = B'
                        $$
        
        \end{xdefinition}

Par cons�quent, une boule $B$ est maximale pour la forme $F$ si aucune autre boule incluse dans cette forme n'inclut $B$.


            \begin{xdefinition}{axe m�dian}
            \indexfr{axe m�dian}
            \label{ske_def_axe_med}

            L'axe m�dian d'une forme $F$ est le lieu des centres des boules maximales de cette forme.

            \end{xdefinition}


Un exemple d'axe m�dian est donn� par la figure~\ref{squelette_continu}. L'axe m�dian est aussi un moyen de compresser l'information puisque la description de cet axe ainsi que la donn�e du rayon de la boule maximale pour chaque point qui en est le centre permet de reconstituer exactement la forme (\citeindex{Rosenfeld1986}).


\indexfr{connexit�}
\indexfr{composante connexe}
\indexfr{homotope}
L'axe m�dian n'est pourtant pas encore le squelette car, m�me si une forme $F$ n'a qu'une composante connexe, l'axe m�dian peut en avoir plusieurs. Il suffit, pour s'en convaincre, de consid�rer deux disques tangents comme l'illustre la figure~\ref{squelette_deux_cercles}. Axe m�dian et forme ne sont donc pas forc�ment homotopes.



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=3cm, width=6cm]
        {\filext{../squelette/image/ske_continu}}\end{array}$}$$
        \caption{    Axe m�dian d'une forme continue (trait pointill�) dont seul le contour est repr�sent�, 
                            figure extraite de~\citeindexfig{Thiel1994}.}
        \label{squelette_continu}
            \end{figure}



            \begin{figure}[ht]
        \[
        \unitlength 1mm
        \fbox{
        \filefig{../squelette/fig_circle}
        }
        \]
        \caption{    Deux disques tangents~: cette forme ne contient qu'une seule composante 
                            connexe alors que son axe
                            m�dian n'est constitu� que de deux points, les deux centres des disques.}
        \label{squelette_deux_cercles}
            \end{figure}




L'axe m�dian, qui est unique, sert de base � la construction d'un squelette, qui ne l'est pas. Il est possible de prolonger ses extremit�s afin d'obtenir un ensemble homotope � la forme d'origine. Mais il n'est pas toujours �vident de les prolonger et c'est pourquoi il est parfois pr�f�rable de rogner la forme jusqu'au squelette, en particulier dans le cas du traitement d'images discr�tis�es qui est l'objet de ce chapitre.






%------------------------------------------------------------------------------------------------------------
\section{4-connexit� ou 8-connexit�}
%------------------------------------------------------------------------------------------------------------
\indexfr{4-connexit�}
\indexfr{8-connexit�}
\indexfrr{connexit�}{4}
\indexfrr{connexit�}{8}
\indexfrr{connexit�}{par arcs}

Afin d'�tre capable de construire le squelette d'une forme, la notion de connexit� doit �tre transpos�e du plan � l'ensemble discret de pixels que forme une image. La figure~\ref{squelette_connexe48} repr�sente un disque et un carr� qui peuvent, selon la d�finition de la connexit� par arc dans une image, �tre ou ne pas �tre scind�s. Les deux figures (disque et carr�) n'en forment qu'une seule si tout point de l'une peut �tre reli� � tout point de l'autre par un chemin inclus dans la r�union des deux.

        \begin{xdefinition}{chemin}
        \indexfr{chemin}
        Un chemin $C$ allant du pixel $x$ au pixel $y$ est une succession de petits d�placements 
        $\pa{v_i}_{1 \infegal i \infegal n}$ telle que~:
        
                $$
                y = x + \summy{i=1}{n} \; v_i
                $$
                
        Ce chemin $C$ est inclus dans un ensemble de pixels $P$ si tous les points emprunt�s par 
        ce chemin appartiennent � $P$~:
        
                $$
                C \text{ est inclus dans } P \Longleftrightarrow     x \in P \text{ et } 
                                                                                                                    \forall k \in \ensemble{1}{n}, \; 
                                                                                                                    x + \summy{i=1}{k} v_i \in P
                $$
                
        \end{xdefinition}


            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=3cm, width=3cm]
        {\filext{../squelette/image/ske_connexe}}\end{array}$}$$
        \caption{    Un disque et un carr� qui se "touchent" en 8-connexit� mais qui sont s�par�s en 4-connexit�.}
        \label{squelette_connexe48}
            \end{figure}


On d�finit deux ensembles de d�placements �l�mentaires, $E_4$ et $E_8$~:

        \begin{eqnarray*}
        E_4     &=&        \acc{ \vecteurim{1}{0}, \vecteurim{0}{1}, \vecteurim{-1}{0}, \vecteurim{0}{-1}   } \\
        E_8     &=&        E_4 \cup \acc{ \vecteurim{1}{1}, \vecteurim{-1}{1}, \vecteurim{-1}{1}, \vecteurim{-1}{-1}   } 
        \end{eqnarray*}


        \begin{xdefinition}{chemin k-connexe}
        Le chemin $C= \pa{v_i}_{1 \infegal i \infegal n}$ est dit $k$-connexe 
        si $\forall i \in \ensemble{1}{n}, \; v_i \in E_k$. 
        \end{xdefinition}

Ceci nous permet de d�finir la 4-connexit� et la 8-connexit�.

        \begin{xdefinition}{4-connexit� et 8-connexit�}
        On consid�re une image $I$ et $P$ une partie de cette image. On dit que $P$ 
        est $k$-connexe ($k \in \acc{4,8}$) si et seulement si pour tout couple de pixels 
        $\pa{x,y} \in P^2$, il existe un chemin $k$-connexe inclus dans $P$ allant de $x$ � $y$.
        \end{xdefinition}


\indexfr{Freeman}
Le code de \emph{Freeman} est tr�s utilis� pour repr�senter les chemins 4-connexe ou 8-connexe. Il consiste � associer � chaque d�placement de $E_8$ un num�ro en tournant dans le sens inverse des aiguilles d'une montre.


            \begin{figure}
            $$
            \begin{tabular}{|c|c|c|}\hline 
                    $
                    \begin{array}{c|c}
                    \vecteurim{1}{0}       &   0 \\ \hline
                    \vecteurim{0}{1}       &   2 \\ \hline
                    \vecteurim{-1}{0}       &   4 \\ \hline
                    \vecteurim{0}{-1}       &   6
                    \end{array}
                    $
                    &
                    $
                    \begin{array}{c|c}
                    \vecteurim{1}{1}       &   1 \\ \hline
                    \vecteurim{-1}{1}       &   3 \\ \hline
                    \vecteurim{-1}{-1}      &   5 \\ \hline
                    \vecteurim{1}{-1}       &   7
                    \end{array}
                    $
                    &
                    \filefig{../squelette/fig_freeman}
                 \\                    
            \hline
            \end{tabular}
            $$
            \caption{ Code de Freeman permettant de coder les huit directions �l�ments d'un pixel vers 
                                un de ses huit voisins en 8-connexit�.}
            \indexfr{Freeman}
            \end{figure}














%------------------------------------------------------------------------------------------------------------
\section{Carte de distance}
%------------------------------------------------------------------------------------------------------------

\indexfrr{carte}{distance}
\indexfrr{distance}{carte}
\label{ske_carte_distance_sec}

        \begin{xdefinition}{carte de distance}
        \label{ske_def_cart_dist_def}
        
        Soit $I_{XY}$ une image binaire, avec $Y$ lignes et $X$ colonnes. $I_{XY}\pa{x,y} \in \acc{0,1}$ 
        d�signe le pixel de coordonn�es $\pa{x,y}$. Soit $d$ une distance entre pixels. On d�signe par 
        $F$ l'ensemble des pixels noirs de l'image $I_{XY}$, soit $F = \acc{ \pa{x,y} \sac I_{XY}\pa{x,y} = 1}$.
        La carte de distance $C^{I_{XY}}$ est
        une matrice de m�mes dimensions que l'image v�rifiant~:
        
                \begin{eqnarray}
                \forall \pa{x,y}, \; C^{I_{XY}}\pa{x,y} = \min \acc{ d\cro{ \pa{x,y}, \pa{x',y'}} 
                                                                                                                            \sac \pa{x',y'} \in \overline{F} } 
                \label{ske_eq_carte_dist}                                                                                                                    
                \end{eqnarray}
        
        \end{xdefinition}

\indexfrr{masque}{distance}
\indexfrr{distance}{masque}

La figure~\ref{ske_cart_dist} illustre une carte de distance pour une distance qui associe � deux pixels le nombre de d�placements verticaux ou horizontaux n�cessaires pour aller de l'un � l'autre. Pour cette figure, la valeur d'une case correspond � la distance entre le pixel noir consid�r� et le pixel blanc le plus proche. Cette distance est introduite car ses maxima locaux ont une forte probabilit� d'appartenir au squelette. Il n'existe pas une unique distance (voir \citeindex{Arcelli1985}), elles sont d�finies en g�n�ral par leur masque (table~\ref{ske_tab_masque_dist}) qui donne leur valeur dans un petit voisinage. Masque et distance sont d�finis comme suit~:


        \begin{table}
        $$
        \begin{tabular}{|c|c|c|} \hline
        $\begin{array}{ccc}
        2 & 1 & 2 \\
        1 & 0 & 1 \\
        2 & 1 & 2 
        \end{array}$
        &
        $\begin{array}{ccc}
        \sqrt{2} & 1 & \sqrt{2} \\
        1 & 0 & 1 \\
        \sqrt{2} & 1 & \sqrt{2} 
        \end{array}$ ou 
        $\begin{array}{ccc}
        4 & 3 & 4 \\
        3 & 0 & 3 \\
        4 & 3 & 4 
        \end{array}$
        &        
        $\begin{array}{ccccc}
        7 & 6 & 5 & 6 & 7 \\
        6 & 4 & 3 & 4 & 6 \\
        5 & 3 & 0 & 3 & 5 \\ 
        6 & 4 & 3 & 4 & 6 \\ 
        7 & 6 & 5 & 6 & 7 \\
        \end{array}$
        \\ \hline 
        \begin{minipage}{3cm}
        Masque de la distance utilis�e pour calculer la carte de la figure~\ref{ske_cart_dist}.
        \end{minipage}
        &
        \begin{minipage}{6.5cm}
        Masques correspondant � la distance euclidienne, le premier est peu utilis� 
        car il implique des calculs r�els plus longs
        que des calculs sur des entiers. $\sqrt{2}$ est de pr�f�rence estim� par un rationnel, 
        $\frac{3}{4}$ ou $\frac{5}{7}$.
        \end{minipage}
        &
        \begin{minipage}{6.5cm}
        Exemple de masque 5x5, si ce masque est not� 
        $M \in M_5\pa{\mathbb{R}} = \pa{m_{ij}}_{ -2 \infegal i,j \infegal 2}$,
        lorsque $m_{20} > 2 m_{10}$, le calcul de distance d�fini en~\ref{squelette_def_dist_masque} ne fera jamais
        intervenir le d�placement $\vecteurim{2}{0}$.
        \end{minipage}
        \\ \hline
        \end{tabular}
        $$
        \caption{Masques de distance~: chaque case contient la distance d'un pixel au pixel central de la matrice.}
        \label{ske_tab_masque_dist}
        \end{table}





        \begin{figure}
        \tiny
        $$
\begin{tabular}{|p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}@{}p{2mm}|}\hline
.& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& 1& 1& 1& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& 1& 1&\textbf{2}& 1& 1& .& .& .& .& 1& 1& 1& 1& 1& .& .& .& .& .\\
.& .& .& 1& 1& 1& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& 1& 2& 2& 2& 1& .& .& 1& 1& 1& 2& 2& 2& 1& 1& 1& .& .& .\\
.& .& 1& 1&\textbf{2}& 1& 1& .& .& .& .& .& .& .& .& .& .& .& .& .& .& 1& 2&\textbf{3}& 2& 1& .& .& 1& 2& 2& 2&\textbf{3}& 2& 2& 2& 1& 1& .& .\\
.& .& 1& 2& 2& 2& 1& .& .& .& .& .& .& .& .& .& .& .& .& .& .& 1& 2&\textbf{3}& 2& 1& .& .& 1& 2& 3& 3& 3& 3& 3& 2& 2& 1& .& .\\
.& 1& 1& 2&\textbf{3}& 2& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 2&\textbf{3}& 2& 1& 1& 1& 1& 2& 3& 4& 4& 4& 3& 3& 2& 1& .& .\\
.& 1& 2& 2&\textbf{3}& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2&\textbf{3}& 2& 2& 2& 2& 2& 2& 3& 4&\textbf{5}& 4&\textbf{4}& 3& 2& 1& .& .\\
.& 1& 1& 2&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}& 3& 3& 4&\textbf{5}& 4&\textbf{4}& 3& 2& 1& .& .\\
.& .& 1& 2&\textbf{3}& 2& 2& 2& 2& 2& 2&\textbf{3}& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2&\textbf{3}& 2& 2& 2& 2& 2& 3&\textbf{4}& 4& 4& 4& 3& 3& 2& 1& .& .\\
.& .& 1& 2&\textbf{3}& 2& 1& 1& 1& 1& 2&\textbf{3}& 2& 1& 1& 1& 1& 1& 1& 1& 1& 1& 2&\textbf{3}& 2& 1& 1& 1& 2& 3&\textbf{4}& \textbf{4}& 3& 3& 3& 2& 2& 1& .& .\\
.& .& 1& 2&\textbf{3}& 2& 1& .& .& 1& 2&\textbf{3}& 2& 1& .& .& .& .& .& .& .& 1& 2&\textbf{3}& 2& 1& .& 1& 2& 3& 3& 3&3& 2& 2& 2& 1& 1& .& .\\
.& .& 1& 2&\textbf{3}& 2& 1& .& .& 1& 2&\textbf{3}& 2& 1& .& .& .& .& .& .& .& 1& 2&\textbf{3}& 2& 1& .& 1& 2& 2& 2& 2&\textbf{3}& 2& 1& 1& 1& .& .& .\\
.& .& 1& 2& 2& 2& 1& .& .& 1& 2&\textbf{3}& 2& 1& 1& 1& 1& 1& 1& 1& 1& 1& 2&\textbf{3}& 2& 1& .& 1& 1& 1& 1& 2&\textbf{3}& 2& 1& .& .& .& .& .\\
.& .& 1& 1&\textbf{2}& 1& 1& .& .& 1& 2&\textbf{3}& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 1& .& .& .& .& 1& 2& 2& 2& 1& .& .& .& .& .\\
.& .& .& 1& 1& 1& .& .& .& 1& 2& 2&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}&\textbf{3}& 2&\textbf{2}& 1& 1& .& .& .& .& 1& 1&\textbf{2}& 1& 1& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& 1& 1& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 2& 1& 1& .& .& .& .& .& .& 1& 1& 1& .& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& .& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& 1& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .\\
.& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .& .\\ 
        \hline
        \end{tabular}
        $$
        \caption{    Carte de distance~: la distance entre deux pixels correspond au nombre de d�placements
                            horizontaux et verticaux n�cessaires pour aller de l'un � l'autre. 
                            La valeur d'une case correspond � la distance entre le pixel noir consid�r� et le pixel blanc 
                            le plus proche.    Les maxima locaux (en gras) ont de forte chance d'appartenir au squelette.
                            Son masque est le 
                            premier de la table~\ref{ske_tab_masque_dist}. Le contour de la forme est l'ensemble des points
                            pour lesquels la carte retourne la valeur 1.}
        \label{ske_cart_dist}
        \indexfr{contour}
        \end{figure}
        




        \begin{xdefinition}{masque de distance}
        \indexfrr{masque}{distance}
        
        Soit $M \in M_{2n+1}\pa{\mathbb{R}} = \pa{m_{ij}}_{ -n \infegal i,j \infegal n}$ une matrice carr�e 
        de dimension $2n+1$. La matrice $M$ est un masque de distance de dimension $n$ si~:
        
                \begin{itemize}
                \item  $\forall \pa{i,j} \neq \pa{0,0}, \; m_{ij} > 0$
                \item  $m_{00} = 0$
                \item  $M$ est sym�trique selon le pixel central
                \end{itemize}
        
        \end{xdefinition}





            \begin{xdefinition}{distance induite par un masque}
            \indexfrr{distance}{induite par un masque}
            \label{squelette_def_dist_masque}
            Soit $M$ un masque de dimension $n$, soient deux pixels $p_1$, $p_2$ et $C\pa{p_1,p_2}$, 
            l'ensemble des chemins allant de $p_1$ et $p_2$ dont les vecteurs sont de longueur inf�rieure ou 
            �gale � $n$. Alors~:
            
                        $$
                        d_M\pa{p_1,p_2} = \underset{c \in C\pa{p_1,p_2}}{\min} \; \summyone{v = \pa{ \begin{subarray} {c}
                                    v_x \\ v_y \end{subarray} }
                                    \in c} m_{v_x, v_y}
                        $$
            
            \end{xdefinition}


L'application d�finie en~\ref{squelette_def_dist_masque} est bien une distance. Comme le masque est sym�trique, elle est aussi  sym�trique. De plus, $d_M\pa{p_1,p_2} = 0 \Longleftrightarrow p_1 = p_2$. L'in�galit� triangulaire est aussi facile � v�rifier puisque pour trois points $p_1,p_2,p$, la concat�nation des chemins allant de $p_1$ � $p$, puis de $p$ � $p_2$ forme un chemin allant de $p_1$ � $p_2$. Par cons�quent~: $d_M\pa{p_1,p_2} \infegal d_M\pa{p_1,p} + d_M\pa{p_2,p}$.

\indexfr{passe d'image}
L'algorithme qui suit permet d'obtenir la carte~\ref{ske_cart_dist} � partir d'une distance d�finie en~\ref{squelette_def_dist_masque} de mani�re rapide, soit en deux "passes" d'image. Plus pr�cis�ment, il est n�cessaire de parcourir deux fois l'ensemble des pixels de l'image afin de construire la carte de distance. Auparavant, on d�finit les deux voisinages de pixels suivants~:

            \begin{eqnarray*}
            V_h\pa{n} &=& \acc{  v = \vecteurimm{v_x}{v_y} \; \left| \; 
                                                -n \infegal v_y \infegal 0 \text{ et } 
                                                 \left\{ \begin{array}{l}  -n \infegal v_x < 0 \text{ si } v_y = 0 \\
                                                                                                            -n \infegal v_x \infegal n \text{ si } v_y < 0 
                                                                                                            \end{array} \right.
                                                                                                            \right. } 
                            \\
            V_b\pa{n} &=& \acc{  v = \vecteurimm{v_x}{v_y} \; \left| \; 
                                                0 \infegal v_y \infegal n \text{ et } 
                                                 \left\{ \begin{array}{l}  0 < v_x \infegal n \text{ si } v_y = 0 \\
                                                                                                            -n \infegal v_x \infegal n \text{ si } v_y > 0 
                                                                                                            \end{array} \right.
                                                                                                            \right. } 
            \end{eqnarray*}
            
Ces deux voisinages sont r�sum�s par la figure~\ref{ske_vois_vb_vh}.




            \begin{figure}
            $$
            \begin{tabular}{|c|}\hline
            \filefig{../squelette/fig_neib}
        \\ \hline
        \end{tabular}
        $$
            \caption{ Voisinages $V_h\pa{n}$ et $V_b\pa{n}$, le voisinage $V_h\pa{n}$ d�signe 
                                la partie situ�e au-dessus et
                                � gauche du pixel central, $V_b\pa{n}$ la partie situ�e au-dessous � et � droite.}
            \label{ske_vois_vb_vh}
            \end{figure}





        \begin{xalgorithm}{carte de distance}
        \indexfrr{carte}{distance}
        \label{ske_algo_cart_dist}
        
        L'objectif est de construire la carte de distance $C$ pour la forme $F$ et d�finie par
        (\ref{ske_eq_carte_dist}) pour la distance induite par le masque $M$ de dimension $n$. 
        $I_{XY}$ est une image avec $X$ colonnes et $Y$ lignes. 
        $\forall \pa{x,y}, \; I_{XY}\pa{x,y} = \indicatrice{\pa{x,y} \in F}$. 
        Pour ne pas alourdir les notations, $I = I_{XY}$ et $C = C^{I_{XY}}$. 
        On impose que $C\pa{x,y} = I\pa{x,y} = \infty$ si $\pa{x,y} \notin \intervalle{1}{X} \times \intervalle{1}{Y}$. 
        
        \begin{xalgostep}{premi�re passe d'image}
                \begin{xfor}{y}{1}{Y}
                    \begin{xfor}{x}{1}{X}
                    $C\pa{x,y} \longleftarrow \left\{ \begin{array}{l}
                                                                    0 \text{ si } I\pa{x,y} = 0 \\
                                                                    \min  \acc{ C\cro{ \pa{x,y} - v} + M_{v_x,v_y} 
                                                                                \sac v \in V_h\pa{n}} \text{ sinon}
                                                                    \end{array}\right.$ 
                    \end{xfor}
                \end{xfor}
        \end{xalgostep}
        
        \begin{xalgostep}{seconde passe d'image}
                \begin{xfor}{y}{Y}{1}
                    \begin{xfor}{x}{X}{1}
                    $C\pa{x,y} \longleftarrow \min\acc{ C\pa{x,y},  \min  
                                \acc{ C\cro{ \pa{x,y} - v} + M_{v_x,v_y} \sac v \in V_b\pa{n}}}$ 
                    \end{xfor}
                \end{xfor}
        \end{xalgostep}
        
        \end{xalgorithm}
        


L'algorithme~\ref{ske_algo_cart_dist} m�ne bien � la carte de distance d�finie par (\ref{ske_eq_carte_dist}). Cette d�monstration est assez simple et s'effectue par r�currence sur $x$ et $y$. La premi�re passe d�termine pour un pixel noir (1) la distance au pixel blanc (0) le plus proche situ� dans une moiti� sup�rieure de l'image. La seconde passe d�termine ce minimum dans la moiti� inf�rieure et choisit le minimum des deux.







%------------------------------------------------------------------------------------------------------------
\section{Squelettisation discr�te}
%------------------------------------------------------------------------------------------------------------
\indexfr{squelette}
\indexfr{squelettisation}


La squelettisation doit aboutir � une image style "fil de fer" comme celle de la figure~\ref{squelette_fig2}. Il existe plusieurs m�thodes de squelettisation discr�te, certaines s'appuient sur une carte de distance comme celle de la figure~\ref{ske_cart_dist}. D'autres approches sont cependant possibles comme par l'interm�diaire d'un graphe de Vorono� (paragraphe~\ref{ske_voronoi_ske_ske}). 











\subsection{Erosion � partir de masques $\pa{3,3}$}
\indexfr{morphomath�matique}
\indexfr{�rosion}
\label{ske_par_erosion}
\indexfrr{masque}{$\pa{3,3}$}



L'�rosion d'une forme consiste � lui retirer l'ensemble des pixels qui forme son contour. Toutefois, l'�rosion d'une forme compos�e d'une seule composante connexe peut aboutir � plusieurs composantes. Son squelette est donc obtenu apr�s plusieurs �rosions successives tout en conservant � chaque �tape des formes homotopes � la forme initiale.

Tout d'abord, on d�finit la fonction $f_k$ qui associe � un pixel un ensemble de pixels correspondant � un de ses voisinages d�finis par la figure~\ref{ske_vois_48con} (4~ou~8 connexit�). On d�finit �galement pour une forme $F$~:


            $$
            f_k \pa{F} = \underset{p \in F}{\cup} \; f_k\pa{p}
            $$
            
Les algorithmes qui suivent supposent fr�quement que la forme � squelettiser ne contient qu'une seule composante connexe. Il suffit de r�p�ter cet algorithme pour chaque composante connexe si ce n'est pas le cas.            
            

        \begin{xalgorithm}{squelettisation par �rosion (1)}
        \indexfr{squelettisation}
        \indexfr{�rosion}
        \label{ske_algo_ske_ero_1}
        
        Pour une forme $F$, on construit son squelette $S_k$ en $k$-connexit� �rosions successives.
        $\overline{S_k}$ d�signe le compl�mentaire de $S_k$ dans l'image. On suppose que $F$ n'a qu'une composante connexe.
        Le squelette est l'ensemble $S_k$ final.
        
        \begin{xalgostep}{initialistion}
                $S_k = F$
        \end{xalgostep}
        
        \begin{xalgostep}{�rosion}\label{ske_algo_ske_ero_a}
                $X \longleftarrow f_{12-k}\pa{\overline{S_k}} \cap S_k$ \\
                $L \longleftarrow \emptyset$ \\
                \begin{xforeach}{p}{X}
                    \begin{xif}{$S_k - \acc{p}$ ne contient qu'une composante connexe}
                        $L \longleftarrow L \cup \acc{p}$
                    \end{xif} 
                \end{xforeach} \\ 
                $S_k \longleftarrow S_k - L$
        \end{xalgostep}
        
        \begin{xalgostep}{terminaison}
                \begin{xif}{$L \neq \emptyset$}
                retour � l'�tape~\ref{ske_algo_ske_ero_a}
                \end{xif}
        \end{xalgostep}
        
        \end{xalgorithm}


            \begin{figure}
            $$
            \begin{tabular}{|c|c|}\hline
                    $\begin{array}{c|c|c} 
                    2 & 1 & 2 \\ \hline
                    1 & 0 & 1 \\ \hline
                    2 & 1 & 2 \medskip
                    \end{array}$ 
                    &
                    $\begin{array}{c|c|c} 
                    1 & 1 & 1 \\ \hline
                    1 & 0 & 1 \\ \hline
                    1 & 1 & 1 \medskip
                    \end{array}$ 
            \\ \hline
            $M_4$ & $M_8$\\ \hline
            \end{tabular}
            $$
            \caption{Masques de distance $M_4$ et $M_8$ utilis�s pour construire un squelette en $k$-connexit�.}
            \label{ske_masque_ske_k_con}
            \end{figure}




L'ensemble $X$ correspond au squelette de la forme en cours d'�rosion. Cet algorithme est assez co�teux puisque, � chaque �tape~\ref{ske_algo_ske_ero_a}, une passe d'image est effectu�e pour construire l'ensemble $f_{12-k}\pa{\overline{S_k}}$. L'id�e est alors d'utiliser la carte de distance (d�finie en~\ref{ske_def_cart_dist_def}) construite � l'aide du masque $M_4$ ou $M_8$ (figure~\ref{ske_masque_ske_k_con}). Cette derni�re contient pour chaque pixel de la forme $F$ un nombre qui correspond presque � l'it�ration de l'�tape~\ref{ske_algo_ske_ero_a} de l'algorithme~\ref{ske_algo_ske_ero_1} dans laquelle il sera trait�.







            \begin{figure}
            $$
            \begin{tabular}{|c|c|}\hline
                    \filefig{../squelette/fig_mask1}
        &
                    \filefig{../squelette/fig_mask2}
        \\ \hline
        $V_4$ & $V_8$ \\ \hline
        \end{tabular}
        $$
            \caption{    Voisinages 4-connexe et 8-connexe~: le voisinage du point central correspond � l'ensemble des
                                cases coch�es.}
            \label{ske_vois_48con}
            \end{figure}




\indexfr{composante connexe}

R�aliser une �rosion sur une forme $F$ revient � chercher tous les points du contour qu'on peut supprimer sans accro�tre le nombre de composantes connexes. Pour cela, il suffit de se limiter � un voisinage 3x3 d'un point du contour et de v�rifier s'il correspond � une des configurations de la figure~\ref{ske_masque_clean_k_con}. Ceci m�ne � l'algorithme suivant~:


            

        \begin{xalgorithm}{squelettisation par �rosion (2)}
        \indexfr{squelettisation}
        \indexfr{�rosion}
        \indexfrr{carte}{distance}
        \label{ske_algo_ske_ero_algo_2}
        \indexfr{masque}
        
        Pour une forme $F$ incluse dans l'image $I$, on construit son squelette $S_4$ en $4$-connexit�, 
        par �rosions successives. Le squelette est l'ensemble $L$ final.
        
        \begin{xalgostep}{carte de distance}
                On construit la carte de distance avec l'algorithme~\ref{ske_algo_cart_dist} et le masque $M_4$ de la
                figure~\ref{ske_masque_ske_k_con}. La forme $F$ est constitu�e des pixel $p$ 
                pour lesquels $C^I\pa{p} > 0$ o� 
                $C$ est la carte de distance. Puis on construit la liste des pixels $L=\vecteur{p_1}{p_n}$. 
                Cette liste est tri�e 
                par ordre de distance croissante~: $i \infegal j \Longrightarrow C^I\pa{p_i} \infegal C^I\pa{p_j}$.
        \end{xalgostep}
        
        \begin{xalgostep}{�rosion}\label{ske_algo_ske_2_a}
                $A \longleftarrow \emptyset$ \\
                \begin{xforeach}{p}{L}
                Si le voisinage du pixel $p$ correspond � une des configurations $N_1$ � $N_7$ de la 
                figure~\ref{ske_masque_clean_k_con} (ou leurs transformations par sym�trie axiale ou rotation) alors~: 
                $A \longleftarrow A \cup \acc{p}$
                \end{xforeach}
        \end{xalgostep}
        
        \begin{xalgostep}{suppression}
                \begin{xif}{$A \neq \emptyset$}
                    $L \longleftarrow L - A$ \\
                    L'ordre initial des pixels dans la liste $L$ doit �tre conserv�. \\
                    Retour � l'�tape~\ref{ske_algo_ske_2_a}.
                \end{xif}        
        \end{xalgostep}
                
        
        \end{xalgorithm}





            

            \begin{figure}
            $$
            \begin{tabular}{|c|c|c|c|c|c|c|}\hline
                    \filefig{../squelette/fig_8mask1}
                &
                    \filefig{../squelette/fig_8mask2}
                &
                    \filefig{../squelette/fig_8mask3}
                &
                    \filefig{../squelette/fig_8mask4}
                &
                    \filefig{../squelette/fig_8mask5}
                &
                    \filefig{../squelette/fig_8mask6}
                &
                    \filefig{../squelette/fig_8mask7}
            \\ \hline
            $N_1$ & $N_2$ & $N_3$ & $N_4$ & $N_5$ & $N_6$ & $N_7$ \\ \hline
            \end{tabular}
            $$
            \caption{    Masques de nettoyage pour construire un squelette en $4$ ou $8$-connexit�. Pour chaque masque,    
                                l'ensemble des cases coch�es correspond � des pixels appartenant � la figure $F$ dont il faut obtenir 
                                le squelette. Si le voisinage du pixel central correspond � une de ces figures, il est nettoy� et 
                                prend la couleur du fond.    Il faut �galement envisager les transformations 
                                (par sym�trie axiale ou rotation) 
                                de ces figures, 4 images par rotation, 4 images par sym�trie axiale, 
                                soit 36 figures diff�rentes au total.}
            \label{ske_masque_clean_k_con}
            \end{figure}



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=3cm, width=6cm]
        {\filext{../squelette/image/ske_decentre}}\end{array}$}$$
        \caption{    Squelette d�centr� obtenu lorsque l'�rosion n'est pas effectu�e 
                            en �liminant d'abord les pixels noirs 
                            les plus proches de pixels blancs, soit lorsque l'algorithme~\ref{ske_algo_ske_ero_algo_2} 
                            ne trie pas l'ensemble $L$. Ce r�sultat est � comparer avec 
                            celui de la figure~\ref{squelette_fig2}.}
        \label{squelette_non_centre}
            \end{figure}

\begin{xremark}{tri de la liste $L$}
\indexfr{tri}
Le tri de la liste $L$ par ordre de distance croissante permet de supprimer d'abord les points du contour avant ceux de l'int�rieur. Si ce tri n'est pas fait, le r�sultat n'est plus aussi parfait (figure~\ref{squelette_non_centre}).
\end{xremark}


\begin{xremark}{masques $N_6$ et $N_7$}
Les masques $N_6$ et $N_7$ (voir figure~\ref{ske_masque_clean_k_con}) sont n�cessaires afin d'�viter que le squelette ne pr�sente des configurations comme celle de la figure~\ref{squelette_non_parfait_recoin} o� il reste une case � nettoyer.
\end{xremark}

            \begin{figure}
                    $$
                    \begin{tabular}{|c|}\hline
                    \filefig{../squelette/fig_maskfail}
                \\ \hline
                \end{tabular}
                $$
                \caption{    L'�rosion de la forme n'est pas termin�e sans l'application
                                    des masques $N_6$ ou $N_7$ de la figure~\ref{ske_masque_clean_k_con}.}
                \label{squelette_non_parfait_recoin}
                \end{figure}


\begin{xremark}{quatre points r�sistants}
L'algorithme de squelettisation~\ref{ske_algo_ske_ero_algo_2} produit une figure particuli�re qui peut �tre d�licate � traiter si l'objectif est de vectoriser le squelette. La figure~\ref{squelette_4_mousquetaires} montre quatre branches qui se rejoignent en un bloc de quatre pixels dont on aurait pr�f�r� qu'ils ne soient qu'un.
\end{xremark}


            \begin{figure}
                    $$
                    \begin{tabular}{|c|}\hline
                    \filefig{../squelette/fig_maskfail2}
                \\ \hline
                \end{tabular}
                $$
                \caption{    Quatre branches li�es par un bloc de quatre pixels, cette figure 
                                    est obtenue pour un squelette
                                    $4$-connexe. }
                \label{squelette_4_mousquetaires}
                  \end{figure}



Le passage � un squelette $8$-connexit� s'effectue en appliquant de nouveaux masques au squelette $4$-connexe. Il s'agit de l'algorithme suivant~:



        \begin{xalgorithm}{squelettisation par �rosion (3)}
        \indexfr{squelettisation}
        \indexfr{�rosion}
        \indexfr{masque}
        \label{ske_algo_ske_ero_algo_3}
        
        Pour une forme $F$ incluse dans l'image $I$, on construit son squelette $S_4$ en 
        $4$-connexit� par �rosions successives. Le squelette est l'ensemble $L$ final.
        
        \begin{xalgostep}{squelette $4$-connexe}
                On construit le squelette $S_4$ ($4$-connexe) gr�ce � l'algorithme~\ref{ske_algo_ske_ero_algo_2}. \\
                $L \longleftarrow S_4$
        \end{xalgostep}
        
        \begin{xalgostep}{�rosion}\label{ske_algo_ske_3_a}
                $A \longleftarrow \emptyset$ \\
                \begin{xforeach}{p}{L}
                Si le voisinage du pixel $p$ correspond � la configuration $N'_1$ de la 
                figure~\ref{ske_masque_clean_k_con_8} (ou � ses transformations) alors~: 
                $A \longleftarrow A \cup \acc{p}$
                \end{xforeach}
        \end{xalgostep}
        
        \begin{xalgostep}{suppression}\label{ske_algo_ske_3_b}
                \begin{xif}{$A \neq \emptyset$}
                    $L \longleftarrow L - A$ \\
                    Retour � l'�tape~\ref{ske_algo_ske_3_a}.
                \end{xif}        
        \end{xalgostep}
                
        
        \end{xalgorithm}
        
        
        
        



            \begin{figure}
            $$
            \begin{tabular}{|c|}\hline
                    \filefig{../squelette/fig_masksp2}
            \\ \hline
            $N'_1$ \\ \hline
            \end{tabular}
            $$
            \caption{    Masque de nettoyage pour construire un squelette en $8$-connexit�. 
                                Pour ce masque, l'ensemble des
                                cases coch�es correspond � des pixels appartenant � la figure $F$, les cases marqu�es 
                                d'un point d'interrogation peuvent �tre coch�es ou non. Si le voisinage du pixel central 
                                correspond � cette figure (ou ses transformations par sysm�trie ou rotation), 
                                il est nettoy� et prend la couleur du fond.
                                }
            \label{ske_masque_clean_k_con_8}
            \end{figure}




    


\indexfr{Marthon}
Dans les algorithmes pr�c�dents (\ref{ske_algo_ske_ero_algo_2} et~\ref{ske_algo_ske_ero_algo_3}), il faut v�rifier le voisinage de chaque pixel correspond � des configurations. L'algorithme qui suit propose une expression simplifi�e de ces v�rifications, il est tir� de~\citeindex{Marthon1979}.


        \begin{xalgorithm}{squelettisation de Marthon}
        \indexfr{squelettisation}
        \indexfrr{carte}{distance}
        \indexfr{�rosion}
        \label{ske_algo_ske_ero_algo_marthon}
        
        Pour une forme $F$ incluse dans l'image $I$, on construit son squelette $S_k$ en $k$-connexit�.
        
        \begin{xalgostep}{carte de distance}
                On construit la carte de distance avec l'algorithme~\ref{ske_algo_cart_dist} et le masque $M_k$ de la
                figure~\ref{ske_masque_ske_k_con}. La forme $F$ est constitu�e des pixels 
                $p$ pour lesquels $C^I\pa{p} > 0$ o� 
                $C$ est la carte de distance. Puis on construit la liste des pixels $L=\vecteur{p_1}{p_n}$. 
                Cette liste est tri�e 
                par ordre de distance croissante~: $i \infegal j \Longrightarrow C^I\pa{p_i} \infegal C^I\pa{p_j}$.
        \end{xalgostep}
        
        \begin{xalgostep}{�rosion}\label{ske_algo_ske_2_a}
                $A \longleftarrow \emptyset$ \\
                \begin{xforeach}{p}{L}
                    Soit $V_k$ le voisinage de la figure~\ref{ske_vois_48con} pour le pixel $p$.\\
                    $\begin{array}{lll}
                    U &\longleftarrow& V_k \cap L \\
                    x &\longleftarrow& \summyone{p' \in U} \; p'_x - p_x \text{ et }    
                                y \longleftarrow \summyone{p' \in U} \; p'_y - p_y \\
                    z &\longleftarrow& \abs{x} + \abs{y}
                    \end{array}$ \\
                    \begin{xif}{$z = 4$}
                        $A \longleftarrow A \cup \acc{p}$ 
                    \xelse
                        \begin{xif}{$z = 3$}
                            selon ses voisins, $A \longleftarrow A \cup \acc{p}$
                        \end{xif}
                    \end{xif}
                \end{xforeach}
        \end{xalgostep}
        
        \begin{xalgostep}{suppression}
                \begin{xif}{$A \neq \emptyset$}
                    $L \longleftarrow L - A$ \\
                    L'ordre initial des pixels dans la liste $L$ doit �tre conserv�. \\
                    Retour � l'�tape~\ref{ske_algo_ske_2_a}.
                \end{xif}        
        \end{xalgostep}
        
        
        \end{xalgorithm}
        















\subsection{Erosion � partir de masques plus larges}
\indexfr{�rosion}
\indexfrr{masque}{$\pa{4,4}$...}
\indexfr{voisinage}


Les �rosions d�crites au paragraphe~\ref{ske_par_erosion} �liminent les pixels en s'appuyant sur un voisinage $\pa{3,3}$ centr� sur le pixel consid�r�, elles m�nent parfois � des configurations ind�sirables (figure~\ref{squelette_4_mousquetaires}) ou �liminent trop de pixels (voir figure~\ref{squelette_elimination_trop}). Pour des algorithmes plus minutieux, il faut avoir recours � un voisinage plus grand. Les probl�mes li�s � la taille du voisinage rencontr�s ici sont similaires � ceux concernant le lissage du contour �voqu� au paragraphe~\ref{image_lissage_contour__} (page~\pageref{image_lissage_contour__}). Certains masques utilis�s pour cette t�che sont d�finis sur des voisinages plus grands que~3x3 (voir figure~\ref{image_lissage_contour}, page~\pageref{image_lissage_contour}) et donnent une id�e de ce qu'il est possible de faire � partir des m�thodes de squelettisation par �rosion.



            \begin{figure}
                    $$
                    \begin{tabular}{|c|c|c|}\hline
                    \filefig{../squelette/fig_nmask1}
                    &                    
                    \filefig{../squelette/fig_nmask2}
                    &                    
                    \filefig{../squelette/fig_nmask3}
                \\ masque 1 & masque 2 & forme � squelettiser \\ \hline
                \end{tabular}
                $$
                \caption{    Le nettoyage de cette forme par les deux masques de gauche ne laisse que trois pixels. }
                \label{squelette_elimination_trop}
                  \end{figure}












\subsection{Ligne de cr�te}
\indexfrr{ligne}{cr�te}
\label{ske_par_crete}

La carte de distance associe � chaque pixel d'une forme $F$ la distance au pixel blanc le plus proche. Si cette distance est consid�r�e comme une altitude, il est possible de d�finir les lignes de cr�tes du paysage form� par la carte. Cette m�thode de squelettisation est compos�e de deux �tapes~:

        \begin{enumerate}
        \item Recherche des maximas locaux~: le squelette inclut les points dont l'altitude est sup�rieure � toutes
                    celles de ses 4 ou 8 voisins.
        \item Prolongations des lignes form�es � l'�tape~1~: la premi�re �tape aboutit � la formation de lignes 
                    discontinues qui doivent �tre prolong�es afin de retrouver un squelette homotope 
                    � la forme d'origine.
        \end{enumerate}
        
Cette m�thode est plus rapide qu'un algorithme bas� sur des �rosions succesives lorsque la forme dont il faut extraire le squelette est "�paisse" car l'algorithme se concentre tout de suite sur les points essentiels.









\subsection{Algorithmes parall�les de squelettisation}
\indexfrr{�rosion}{parall�le}
\indexfrr{squelettisation}{parall�le}
\indexfr{processus}
\label{ske_squelettisation_parallele}


Les algorithmes de squelettisation bas�s sur une �rosion � l'aide de masques incluent de nombreux tests sur les pixels. En divisant cet ensemble de masques en plusieurs groupes disjoints (ou de faible intersection), il est possible de parall�liser ces algorithmes~: dans ce cas, plusieurs processus  -~autant qu'il y a de groupes~- �rodent l'image, chacun capable de n'enlever que des pixels v�rifiant la configuration d�crite par le groupe de masques qui lui est associ�. La parall�lisation ne rend pas l'algorithme moins co�teux mais permet de dimininuer son temps d'ex�cution. L'article \citeindex{ZhangY1997} s'int�resse � quatre de ces algorithmes utilis�s avec deux processus. Il compare leur co�t et leur redondance, qui est d�finie ici comme l'intersection entre les deux groupes de masques utilis�s.










\subsection{Extraction du squelette bas�e sur un crit�re de connexit�}
\indexfrr{crit�re}{connexit�}
\label{ske_critere_connexite}

La m�thode est tir�e de l'article \citeindex{Choi2003}. Si on consid�re un point $P$ d'une forme � squelettiser, on note $Q\pa{P}$ le point le plus proche de $P$ appartenant au contour, on note �galement $\pa{P_i}_{1 \infegal i \infegal 8}$ les huits voisins de $P$. A priori, si le point $P$ n'appartient pas au squelette, l'ensemble de points $\pa{Q\pa{P_i}}_{1 \infegal i \infegal 8}$ seront proches les uns des autres. En revanche, si le point $P$ appartient au squelette, l'ensemble $\pa{Q\pa{P_i}}_{1 \infegal i \infegal 8}$ sera dispers� sur deux bords oppos�s du contour (voir figure~\ref{ske_choi2003}).


        \begin{figure}[ht]
        $$\begin{tabular}{|c|}\hline 
        \filefig{../squelette/fig_choi}
        \\ \hline \end{tabular}$$
        \caption{    Id�e sous-jacente de la squelettisation propos�e par~\citeindexfig{Choi2003}.
                            Le point $A$ n'est pas situ� sur le squelette, tous ses voisins sont plus proches
                            du bord sup�rieur que du bord sup�rieur. A l'inverse, le point $B$ appartient au
                            squelette, ses voisins, selon leur position par rapport � $A$, sont plus proches
                            soit du bord sup�rieur, soit du bord inf�rieur.}
        \label{ske_choi2003}
        \end{figure}


\indexfrr{carte}{distance}

L'algorithme suppose de conna�tre pour chaque pixel de la forme le point le plus proche appartenant au contour, cette information peut �tre obtenue facilement � partir des cartes de distance (voir paragraphe~\ref{ske_carte_distance_sec}) en conservant le pixel ayant permis d'atteindre le minimum de distance (la carte de distance est ici estim�e pour une forme r�duite � son contour).

        \begin{xalgorithm}{squelettisation (Choi2003)}
        La forme � squelettiser est not�e $F$, son contour est not� $\overline{F}$ et son squelette $S\pa{F}$. 
        On note $\rho > 0$ un param�tre r�el et positif. On note �galement $X\pa{P}$ et $Y\pa{P}$ 
        respectivement l'abscisse et l'ordonn�e de $P$.
        
        \begin{xalgostep}{carte de distance}
        Calcul d'une carte de distance permettant d'associer � chaque pixel $P \in F$ 
        le point $Q\pa{P} \in \overline{F}$.
        \end{xalgostep}
        
        \begin{xalgostep}{squelettisation}
        Pour tout point $P \in F$, soit $\pa{P_i}_{1 \infegal i \infegal 8}$ les voinsins de $P$ 
        en 8-connexit�, on d�finit~:
        
                $$
                \forall i \in \ensemble{1}{8}, \; Q_i = Q\pa{P_i} + P - P_i
                $$
                
        Alors $P$ appartient au squelette s'il existe $i \in \ensemble{1}{8}$ tel que~:
        
                \begin{eqnarray}
                \norme{Q_i - Q\pa{P}}^2         &\supegal& \rho  \label{squelette_choi_condition_1}\\
                \text{et } \norme{Q_i}^2 - \norme{Q}^2    &\infegal& \max \acc{ X\pa{Q_i - Q}, \; Y\pa{Q_i - Q}}
                \end{eqnarray}
                
        \end{xalgostep}
        \end{xalgorithm}


Le co�t de cet algorithme est lin�aire par rapport au nombre de pixels de la forme � squelettiser, ce qui repr�sente un avantage certain par rapport aux algorithmes bas�s sur une �rosion (voir paragraphe~\ref{ske_par_erosion}). Il reste � ajuster la valeur $\rho$, petite pour des squelettes fournis, grande pour des squelettes d�garnis (voir figure~\ref{squelette_choi_connexite}). Sans la seconde condition de l'algorithme, le squelette obtenu a trois pixels d'�paisseur, cette condition permet de ramener cette �paisseur sur un pixel dans la majorit� des cas. Il est parfois souhaitable d'affiner le r�sultat par une �tape d'�rosion afin d'obtenir l'epaisseur ou la connexit� voulues.




            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=5cm, width=12cm]
        {\filext{../squelette/image/choi}}\end{array}$}$$
        \caption{    Squelettisation � partir d'un crit�re de connexit�, squelettes obtenus pour
                            diff�rentes valeurs du param�tre $\rho$ (figure extraite de~\citeindexfig{Choi2003}).}
        \label{squelette_choi_connexite}
            \end{figure}



\begin{xremark}{pertes de connexit�}
Cet algortihme n'est pas bien adapt� � la squelettisation des caract�res manuscrits. Ces formes sont souvent tr�s fines et le r�sultat final pr�sente de nombreuses barbules et quelques pertes de connexit� dues � la condition~(\ref{squelette_choi_condition_1}) qui d�truit le squelette dans les zones dont l'�paisseur est trop fine.
\end{xremark}











\subsection{Squelettisation � partir de filtre de Gabor}
\indexfr{Gabor}
\indexfrr{filtrage}{Gabor}
\indexfrr{squelettisation}{Gabor}
\label{ske_squelettisation_gabor}

L'article \citeindex{Su2003} propose une m�thode fond�e sur les filtres de Gabor et l'applique au cas des caract�res chinois. Ces caract�res sont principalement compos�s des traits verticaux, horizontaux et diagonaux, une premi�re �tape de filtrage permet d'extraire ces quatre types de traits comme le montre la figure~\ref{squelette_su_gabor_1}, chaque trait est ensuite vectoris� ce qui permet d'obtenir une premi�re approximation du squelette (avant-derni�re colonne de la figure~\ref{squelette_su_gabor_1}). Les traits sont ensuite reconnect�s entre eux pour obtenir le squelette final selon des crit�res de proximit�s et de direction. L'avantage de cette m�thode est sa grande stabilit� par rapport au bruit comme le montre les deux derni�res lignes de la figure~\ref{squelette_su_gabor_1}. Les post-traitements regroupant le nettoyage et la connexion des traits succ�dent au filtrage de Gabor. Comme ils sont ind�pendants de la squelettisation, seul le filtrage de Gabor sera d�crit.


            \begin{figure}[ht]
        $$\begin{tabular}[c]{|rc|}\hline
        image nette         & \includegraphics[height=2cm, width=10cm]{\filext{../squelette/image/su1}} \\
        image bruit�e     & \includegraphics[height=2cm, width=10cm]{\filext{../squelette/image/su2}} \\
        contour alt�r�     & \includegraphics[height=2cm, width=10cm]{\filext{../squelette/image/su3}} 
        \\ \hline \end{tabular}$$
        \caption{    Extraction des traits d'une image selon quatre directions, verticale, horizontale, diagonales,
                            � l'aide de filtres de Gabor, figure extraite de \citeindexfig{Su2003}). La premi�re ligne
                            montre le r�sultat sur une image nette, la seconde ligne sur une image bruit�e al�atoirement,
                            la derni�re ligne, sur une image dont le contour a �t� alt�r�.}
        \label{squelette_su_gabor_1}
            \end{figure}

On note $i\pa{x,y} \in \cro{0,1}$ l'intensit� de l'image, et $h\pa{x,y}$ le filtre de Gabor d�fini par~:

            \begin{eqnarray}
            h\pa{x,y} &=&\exp\pa{ -\pi \; \frac{x^2 + y^2}{\sigma^2} } \; 
                                                    \exp\pa { 2i \pi \, f \, \pa{ x \, \cos \theta + j \, \sin \theta } }
            \end{eqnarray}
            
La r�ponse de l'image au filtre de Gabor est not�e $I\pa{x,y}$~:


            \begin{eqnarray}
            I\pa{x,y} &=&        \abs{ i\pa{x,y} \otimes h\pa{x,y} }
            \end{eqnarray}

Les param�tres utilis�es sont les suivants~:

            $$
            \begin{array}{cc}
            \sigma = \frac{ \sqrt{2} }{f} & f = 0,9857 \frac{ e } {dh }
            \end{array}
            $$
            
$e$ est l'�paisseur moyenne des traits (voir paragraphe~\ref{image_epaisseur_trace}, page~\pageref{image_epaisseur_trace}), $h$ est la hauteur de l'image, $d$ est la densit� de l'image o� le rapport entre le nombre de pixels noirs et la taille de d'image. L'angle $\theta$ prend quatre valeurs pour les quatre directions d�sir�es~: $\theta \in \acc{0, \frac{\pi}{4}, \frac{\pi}{2}, \frac{3\pi}{4} }$, le r�sultat de ces quatre filtres est illustr� par la figure~\ref{squelette_su_gabor_2}.


            \begin{figure}[ht]
        $$\begin{tabular}{|c|}\hline
        \includegraphics[height=3cm, width=14cm]{\filext{../squelette/image/su4}} 
        \\ \hline \end{tabular}$$
        \caption{    R�ponses des quatres filtres de Gabor correspondant aux quatre directions, 
                            $0^\circ$, $45^\circ$, $90^\circ$, $135^\circ$, figure extraite de \citeindexfig{Su2003}.}
        \label{squelette_su_gabor_2}
            \end{figure}

Ces quatre images sont ensuite binaris�es pour obtenir les quatre images $K_n\pa{x,y}_{1 \infegal n \infegal 4}$~:


            \begin{eqnarray}
            \forall \pa{x,y}, \; K_n\pa{x,y} &=& \indicatrice{ I_n\pa{x,y} \supegal \alpha }
            \end{eqnarray}

Le seuil $\alpha$ est calcul� de mani�re it�rative de fa�on � ce que les quatre images $K_n$ ne contiennent pas d'informations redondantes, deux autres images sont alors construites~:

            \begin{eqnarray}
            \forall \pa{x,y}, \; M_\alpha \pa{x,y} &=& \summy{n=1}{4} \; K_n\pa{x,y} \\
            \forall \pa{x,y}, \; N_\alpha \pa{x,y} &=& \summy{n=1}{4} \; \indicatrice{ M_\alpha \pa{x,y} \supegal 1}
            \end{eqnarray}

\indexfrr{erreur}{perte}
\indexfrr{erreur}{recouvrement}
\indexfr{recouvrement}

Les quatre images $K_n$ permettent de reconstruire l'image originale, deux types d'erreurs sont alors quantifi�s, l'erreur en perte $E_p\pa{\alpha}$ et l'erreur de recouvrement $E_r\pa{\alpha}$~:

            \begin{eqnarray}
            \begin{array}{ccc}
            E_p\pa{\alpha}   =  \frac{ \summyone{x,y} \; \abs{ N_\alpha \pa{x,y} - i\pa{x,y} } } 
                                                                { \summyone{x,y} \; i\pa{x,y} } &&
            E_r\pa{\alpha}   =  \frac{ \summyone{M_\alpha \pa{x,y} > 1} \; M_\alpha \pa{x,y} - i\pa{x,y}  } 
                                                                { \summyone{x,y} \; i\pa{x,y} } 
            \end{array}
            \end{eqnarray}
            
L'erreur globale est d�finie comme la moyenne des deux~: $E\pa{\alpha} = \frac{1}{2} \pa{ E_r\pa{\alpha} + E_p\pa{\alpha}}$. Le seuil $\alpha$ est choisi comme la limite de la suite $\alpha_t$ d�finie par~:

            \begin{eqnarray}
            \alpha_0           &\in&  \cro{0,1}  \\
            \alpha_{t+1}    &=&        \alpha_t + \cro{ \indicatrice{ E\pa{\alpha_t} \supegal E\pa{\alpha_{t-1}}} - 
                                                                                    \indicatrice{ E\pa{\alpha_t} < E\pa{\alpha_{t-1}}}   }
                                                    \; \tanh \pa{ \frac{ E\pa{\alpha} }{2} }
            \end{eqnarray}            
            
Les images obtenus apr�s ce seuillage ne sont pas encore parfaites (voir figure~\ref{squelette_su_gabor_3}), elles sont ensuite nettoy�es des trop petits segments en tenant compte des attributs tels que la surface et la longueur, leur pr�sence sur plus d'une image.



            \begin{figure}[ht]
        $$\begin{tabular}{|c|}\hline
        \includegraphics[height=3cm, width=14cm]{\filext{../squelette/image/su5}} 
        \\ \hline \end{tabular}$$
        \caption{    R�ponses seuill�es des quatres filtres de Gabor 
                            correspondant aux quatres directions verticale, horizontale,
                            diagonales, figure extraite de \citeindexfig{Su2003}. 
                            Les petits segments entour�s vont �tre supprim�s par le nettoyage.}
        \label{squelette_su_gabor_3}
            \end{figure}































%------------------------------------------------------------------------------------------------------------------
\section{Squelettisation d'une forme vectorielle}
%------------------------------------------------------------------------------------------------------------------
\indexfrr{forme}{vectorielle}



Ces m�thodes diff�rent des pr�c�dentes car elles utilisent uniquement le contour de la forme � squelettiser, ce dernier �tant d�crit comme une succession de segments. Les m�thodes d'�rosion, quant � elles, partent d'une forme d�crite par un ensemble de pixels connexes. Il est bien s�r possible d'appliquer les m�thodes vectorielles � ces ensembles de pixels en les r�duisant � leur contour. Les pixels du contour obtenus sont alors les sommets des segments. Afin de r�duire la complexit� des m�thodes vectorielles, l'ensemble des pixels formant le contour est souvent r�duit. Les sommets utilis�s pour la squelettisation sont r�partis � �gale distance le long de la courbe (voir figure~\ref{squelette_voronoi}) ou celle-ci peut-�tre vectoris�e de mani�re � regrouper ensemble des segments successifs colin�aires (voir figure~\ref{squelette_reseau_bissecteur}).



\subsection{Diagramme de Vorono�}
\indexfr{Vorono�}\indexfr{m�diatrice}
\label{ske_voronoi_ske_ske}

            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=8cm, width=12cm]
        {\filext{../squelette/image/ske_voronoi}}\end{array}$}$$
        \caption{    Squelettisation � partir d'un graphe de Vorono�, figure extraite de~\citeindexfig{Attali1995}.}
        \label{squelette_voronoi}
            \end{figure}

\indexfr{axe m�dian}

La d�finition de l'axe m�dian (\ref{ske_def_axe_med}) fait intervenir le centre de boules tangentes en au moins deux points du contour de cette forme. Par cons�quent, en consid�rant deux points du contour, le squelette est susceptible de passer par la m�diatrice de ces deux points. Le diagramme de Vorono� est justement un ensemble de m�diatrices. Il suffit alors de disposer des points �parpill�s sur le contour, de d�terminer le diagramme de Vorono� puis de l'�laguer pour ne garder que les segments de m�diatrice emprunt�s par le squelette. Cette id�e a �t� developp�e dans~\citeindex{Ogniewicz1992}, \citeindex{Ogniewicz1995}, ou encore~\citeindex{Attali1995}. La figure~\ref{squelette_voronoi} montre que le squelette est plus pr�cis lorsque les points sur le contour sont plus nombreux mais �videmment plus lent � calculer. Une fois que le diagramme de Vorono� associ� � une forme est construit, le squelette est tout simplement constitu� des seuls segments inclus dans l'int�rieur de cette forme.






\subsection{R�seau bissecteur}
\indexfrr{r�seau}{bissecteur}
\label{ske_reseau_bissecteur}

La squelettisation par r�seau bissecteur est assez proche de celle developp�e � partir d'un diagramme de Vorono� (voir~\citeindex{Cloppet2000}). Une forme est d�finie par son contour lui-m�me d�fini comme une succession d'ar�tes. Les premiers  n\oe uds du r�seau bissecteur sont form�s par les bissectrices de chaque angle. Lorsque deux bissectrices s'interceptent, elles forment un angle dont on peut � nouveau tracer la bissectrice (voir figure~\ref{squelette_reseau_bissecteur}). Ce graphe est similaire � celui obtenu par le diagramme de Vorono�, le squelette est simplement une sous-partie de ce diagramme.



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=4cm, width=4cm]
        {\filext{../squelette/image/ske_bis}}\end{array}$}$$
        \caption{    Squelettisation � partir d'un r�seau bissecteur, figure extraite de~\citeindexfig{Cloppet2000}.}
        \label{squelette_reseau_bissecteur}
            \end{figure}
















%------------------------------------------------------------------------------------------------------------
\section{Affinement du r�sultat}
%------------------------------------------------------------------------------------------------------------






\subsection{Nettoyage des barbules}
\label{ske_par_barbule}
\indexfrr{nettoyage}{barbule}
\indexfr{barbule}


\indexfr{axe m�dian}\indexfr{composante connexe}

Le squelette d'une image est sa repr�sentation en "fil de fer", celle-ci peut-�tre plus ou moins pr�cise. Apr�s la squelettisation, un grand nombre de petits segments du squelette peuvent s'av�rer non pertinents comme le montre la figure~\ref{squelette_barbule}. Le squelette d'un mot manuscrit devrait �tre proche du mouvement du stylo. Toutefois, la squelettisation conserve un ensemble de petits segments sans importance dont la suppression ne modifie pas le nombre de composantes connexes. Nettoy� de ces barbules, le squelette est en quelque sorte plus "lisible" mais il n'y a pas de r�gles pour ce nettoyage, il d�pend � la fois de l'algorithme de squelettisation employ� et de la pr�cision d�sir�e.



            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|}\hline
        \includegraphics[height=4cm, width=4cm]{\filext{../squelette/image/ske_barbule2}}&
        \includegraphics[height=4cm, width=4cm]{\filext{../squelette/image/ske_barbule1}} \\ \hline
        \end{tabular}$$
        \caption{    La seconde image repr�sente le squelette de la premi�re image nettoy� de ses barbules, 
                            la seconde image contient simplement l'information pertinente.}
        \label{squelette_barbule}
            \end{figure}


Ce nettoyage peut s'appuyer sur des crit�res g�om�triques tel que celui propos� dans \citeindex{Jang1992} qui mesure le rapport entre la forme $F$ � squelettiser et l'aire form�e par l'ensemble $G$ des boules maximales incluses dans $F$ dont le centre appartient au squelette. Par d�finition, $G \subset F$, le crit�re de \citeindex{Jang1992} est �gal �~:

                \begin{eqnarray}
                c_J   =  \frac{ aire\pa{G} } { aire \pa{F} }  \infegal 1
                \end{eqnarray}
                
Le squelette est rogn� � ses extr�mit�s tant que le crit�re $c_J$ est sup�rieur � un certain seuil. Un autre crit�re provient de \citeindex{Huang2003} qui compare les longueurs (en pixel) du squelette et du contour~:

                \begin{eqnarray}
                c_H   =  \frac{ aire\pa{squelette} } { aire \pa{contour} }  \infegal 1
                \label{squelette_haung_critere}
                \end{eqnarray}







\subsection{Squelette d'une boucle}
\indexfrr{squelette}{boucle}


Cet article \citeindex{Huang2003} propose �galement d'effectuer l'�rosion de la forme tant que le crit�re $c_H$ (\ref{squelette_haung_critere}) est sup�rieur � un certain seuil. Par cons�quent, pour un seuil bien ajust�, les zones peu �paisses sont bien squelettis�es tandis que les zones �paisses sont un compromis entre squelette et contour, la figure~\ref{squelette_barbule_six_stop} montre le r�sultat qu'il est possible d'obtenir avec ce genre de m�thode. Le squelette du chiffre "6" est obtenu avec sa boucle bien que celle-ci soit combl�e de pixels noirs.



            \begin{figure}[ht]
        $$\begin{tabular}{|c|}\hline
        \includegraphics[height=2cm, width=1.2cm]{\filext{../squelette/image/sixstop}}
        \\ \hline \end{tabular}$$
        \caption{    Le squelette de cet image est une �tape interm�diaire entre le contour et le v�ritable squelette.
                            Ce r�sultat est pourtant proche de celui qu'il faut obtenir puisque la boucle du chiffre "6"
                            dispara�t avec un algorithme de squelettisation classique.}
        \label{squelette_barbule_six_stop}
            \end{figure}











\subsection{Am�liorer la repr�sentation des intersections}

\indexfrr{instersection}{squelette}
\indexfrr{squelette}{instersection}
\indexfrr{squelette}{embranchement}

Lors de l'extraction du squelette d'un caract�re, les intersections entre deux segments de droites sont souvent scind�es comme le montre la figure~\ref{squelette_zhong_intersection}b. La m�thode d�velopp�e dans \citeindex{Zhong1999} propose de corriger le squelette obtenu en figure~\ref{squelette_zhong_intersection}b pour aboutir � celui~\ref{squelette_zhong_intersection}c.  La m�thode est appliqu�e sur des caract�res chinois qui pr�sentent souvent des intersections croisant un trait horizontal et un trait vertical. En explorant l'image initiale selon des lignes parall�les aux diagonales, il est possible de marquer quatre types de points caract�ristiques d'une intersection (voir figure~\ref{squelette_zhong_intersection}d qui indique le d�but ou la fin d'un embranchement). 

            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|c|c|} \hline
        \includegraphics[height=3cm, width=3cm]{\filext{../squelette/image/cross1}} & 
        \includegraphics[height=3cm, width=3cm]{\filext{../squelette/image/cross2}} & 
        \includegraphics[height=3cm, width=3cm]{\filext{../squelette/image/cross3}} &
        \includegraphics[height=3cm, width=3cm]{\filext{../squelette/image/cross4}} \\
        $(a)$ & $(b)$ & $(c)$ & $(d)$ 
        \\ \hline \end{tabular}$$
        \caption{    Correction du squelette afin de mieux repr�senter les intersections, figures extraites 
                            de~\citeindexfig{Zhong1999}). L'image~(\textit{d}) montre les quatre points cardinaux 
                            d'une intersection. L'objectif de la m�thode est de passer l'image~(\textit{b})
                            � l'image~(\textit{c}). Avant l'�rosion, des points cardinaux sont d�tect�s, symbolisant
                            chacun un embranchement. Quatre d'entre eux � la figure~(\textit{d}) 
                            permettent de rep�rer une intersection, le squelette � l'int�rieur de la zone encadr�e par 
                            ces quatre points ne sera pas issu d'une �rosion mais deux droites joignant les quatre extr�mit�s
                            du squelette situ�es aux limites de cette zone. }
        \label{squelette_zhong_intersection}
            \end{figure}


\indexfr{run-length}
\indexfrr{squelette}{divergence}
\indexfrr{squelette}{convergence}

Le squelette est alors corrig� en effa�ant tout d'abord la partie incluse entre ces quatre points puis en faisant converger vers un m�me et unique point les quatre extremit�s du squelette le reliant � cette zone.

Les points caract�ristiques sont d�tect�s � l'aide des "run-length" d�finis dans l'article comme des segments de points contig�s ou  ensembles de pixels noirs contig�s positionn�s sur la m�me ligne. Les embranchements sont d�tect�s en �tudiant le nombre de "run-length" et leur chevauchement. Un "run-length" chevauchant deux "run-length" de la ligne suivante d�signent une divergence. La configuration oppos�e d�signe une convergence.









\subsection{Mod�liser les intersections dans les caract�res}
\indexfrr{intersection}{squelette}
\indexfr{reconstruction du trac�}
\indexfrr{trac�}{reconstruction}
\label{squelette_modelisation_intersection_modele}

L'article \citeindex{L'Homer2000} propose une mod�lisation int�ressante du squelette. Cet article s'int�resse tout particuli�rement � la squelettisation de caract�res manuscrits et cherche � extraire un squelette d�crit comme une fonction d�pendant du temps et proche de l'�volution du stylo sur la feuille de papier. L'auteur construit un mod�le permettant de d�composer le trac� d'une lettre sous forme d'arcs continus et r�guliers (la d�riv�e est born�e) repr�sent�s dans la troisi�me ligne de la figure~\ref{squelette_lhomer_intersection}. 

            \begin{figure}[ht]
        $$\begin{tabular}{|c|} \hline
        \includegraphics[height=6cm, width=8cm]{\filext{../squelette/image/lhomer}}
        \\ \hline \end{tabular}$$
        \caption{    Figure extraite de~\citeindexfig{L'Homer2000} repr�sentant la mod�lisation de diff�rentes lettres "a".
                            Les arcs formant ces lettres peuvent se rejoindre dans un point de rebroussement (premier colonne),
                            s'intercepter comme pour la barre d'un "T" (seconde colonne), se croiser (derni�re colonne).}
        \label{squelette_lhomer_intersection}
            \end{figure}


\indexfrr{arc}{r�gulier}\indexfr{jointure}\indexfr{croisement}\indexfrr{point}{rebroussement}

L'algorithme d�tecte les arcs r�guliers (premi�re ligne de la figure~\ref{squelette_lhomer_intersection}) ainsi que leurs extremit�s devant �tre jointes. L'attrait de cet article r�side essentiellement dans la fa�on de r�aliser ces jointures. Certains croisements repr�sentent deux traits qui se rejoignent � un point de rebroussement (premi�re lettre~"a" de la figure~\ref{squelette_lhomer_intersection}), d'autres repr�sentent des traits qui se croisent (derni�re lettre~"a" de la figure~\ref{squelette_lhomer_intersection}). La liste des mod�les de jointures est illustr�e par la figure~\ref{squelette_lhomer_intersection_modele}. Le mod�le le plus probable tend � conserver les courbes les plus r�guli�res possibles.


            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|} \hline
        \includegraphics[height=5cm, width=5cm]{\filext{../squelette/image/lhomer3}} &
        \includegraphics[height=5cm, width=5cm]{\filext{../squelette/image/lhomer4}} 
        \\ \hline \end{tabular}$$
        \caption{    Figure extraite de~\citeindexfig{L'Homer2000} repr�sentant les diff�rentes 
                            types des jointures entre arcs.
                            Un m�me trait peut cacher deux passages du stylo et c'est ce que ces mod�les tentent de d�tecter.    
                            La premi�re image pr�sente les huit possibilit�s de branchements lorsque trois arcs se croisent. 
                            La seconde image pr�sente les seize possibilit�s de branchements lorsque quatre arcs se croisent.}
        \label{squelette_lhomer_intersection_modele}
            \end{figure}


Cette repr�sentation du squelette est con�ue pour des caract�res manuscrits et propose une description du squelette plus �volu�e que les pr�c�dentes. La d�tection de figures particuli�res incluses dans les caract�res se contente souvent des boucles. Cet article propose une description sous forme d'arcs r�guliers ainsi que les types d'intersections les reliant entre eux. Il pourrait �tre int�ressant d'�tudier l'apport de telles caract�ristiques pour la reconnaissance des caract�res.

Cette m�thode propose � la fois une repr�sentation param�tr�e du squelette ainsi qu'une am�lioration de la description des intersections. Cette repr�sentation sous forme d'arcs est guid�e par la forme des caract�res et m�me si la plupart des m�thodes abord�es dans ce document ont traits � ce domaine, il est possible d'adopter des repr�sentations param�triques du squelette plus simple mais plus g�n�rales, par exemple, sous forme de droites. Ce processus s'appelle la vectorisation et est pr�sent�e dans les paragraphes qui suivent.










%------------------------------------------------------------------------------------------------------------
\section{Post-traitements}
%------------------------------------------------------------------------------------------------------------




\subsection{Vectorisation du squelette}
\indexfrr{vectorisation}{squelette}


Le squelette obtenu est une suite de pixels. Il peut �tre int�ressant de le vectoriser, autrement dit de le d�crire � l'aide de segments de droites. Cette vectorisation peut consister en la recherche des droites qui auraient permis le trac� du squelette comme le sugg�re les th�ses~\citeindex{Reveill�s1991} et \citeindex{Vittone1999}. Ces travaux utilisent la d�finition suivante (extraite de~\citeindex{Reveill�s1991})~:



        \begin{xdefinition}{droite discr�te}
        \indexfrr{droite}{discr�te}
        \label{squelette_droite_discrete_def}
        
        Soient $\pa{a,b,r} \in \mathbb{Z}^2$ et $\omega \in \N^*$. Une droite de vecteur directeur $\pa{b,a}$ 
        avec $\pa{a,b} \neq \pa{0,0}$ et $pgcd\pa{a,b}=1$, de param�tre de translation $r$ et d'�paisseur
        arithm�tique $\omega$ est l'ensemble not� $D\pa{a,b,r,\omega}$ des points $\pa{x,y} \in \mathbb{Z}^2$
        satisfaisant l'in�galit�~:
        
                    $$
                    0 \infegal ax + by + r < \omega
                    $$
        
        De plus~:
        
                    $$
                    \begin{tabular}{lcl}
                    si $1 \infegal w \infegal max\pa{\abs{a},\abs{b}}$ & alors & 
                                la droite n'est pas connexe et est dite d�connect�e. \\
                    si $\omega = max\pa{\abs{a},\abs{b}}$ & alors & la droite est 8-connexe. \\
                    si $max\pa{\abs{a},\abs{b}} \infegal \omega \abs{a} + \abs{b}$ & alors & 
                                la droite est 8-connexe et 4-connexe par moment. \\
                    si $\omega = \abs{a} + \abs{b}$ & alors & la droite est 4-connexe. \\
                    si $\omega > \abs{a} + \abs{b}$ & alors & la droite est �paisse
                    \end{tabular}
                    $$
        
        \end{xdefinition}


D'un point de vue plus pragmatique, l'article~\citeindex{Freeman1970} d�crit les trois propri�t�s v�rifi�es par le code de Freeman\indexfr{Freeman} d'une ligne $8$-connexe~:


            \begin{enumerate}
            \item Au plus deux directions peuvent �tre pr�sentes dans le code et ne peuvent diff�rer que d'une
                        unit� modulo $8$.
            \item Une des deux directions appara�t toujours de mani�re isol�e.
            \item La direction isol�e appara�t de mani�re uniforme dans le code.
            \end{enumerate}

La premi�re propri�t� permet d'isoler les portions de code susceptibles de repr�senter des droites, les deux suivantes permettent d'estimer les param�tres de son �quation. En effet, les occurences des deux directions intervenant dans la description m�nent directement au vecteur directeur de la droite. Les algorithmes d�velopp�s dans~\citeindex{Vittone1999} ou~\citeindex{Breton2002} utilisent la d�finition~\ref{squelette_droite_discrete_def} et retrouvent les segments de droite au pixel pr�s comme le montre la figure~\ref{squelette_vector}~: la droite est recouverte par l'ensemble de pixels vectoris�s par cette droite.


            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=2cm, width=4cm]
        {\filext{../squelette/image/ske_vector}}\end{array}$}$$
        \caption{    Vectorisation d'un contour : figure extraite de~\citeindexfig{Breton2002}, le contour vectoris�
                            est recouvert par l'ensemble de pixels formant le contour. }
        \label{squelette_vector}
            \end{figure}


Une autre m�thode permet de vectoriser un arc quelconque de mani�re approch�e. Si cet arc est proche d'une droite alors la corde reliant ses deux extr�mit�s est une bonne approximation (voir figure~\ref{squelette_vector_corde}). En revanche, si cet arc n'est pas une droite, la corde est une mauvaise approximation, l'arc est alors divis� en deux parties dont l'extr�mit� commune est le point de l'arc le plus �loign� de sa corde. Ceci m�ne � l'algorithme suivant~:


        \begin{xalgorithm}{vectorisation approch�e}
        \indexfrr{vectorisation}{approch�e}\label{algo_vecto_appro}
        
        Soit un arc $k$-connexe d�fini par une suite de pixels $\vecteur{p_1}{p_n}$ v�rifiant~:
        
                    $$
                  \forall i \in \intervalle{2}{n}, \; p_{i-1} \in V_k\pa{p_i}
                    $$
        
        On calcule le crit�re $c$ d�fini par~:
        
                    $$
                    c = \underset{i \in \intervalle{1}{n} }{\max} \;  d\pa{p_i, D\pa{p_1,p_n} }
                    $$
        
        o� $d\pa{p_i, D\pa{p_1,p_n}}$ est la distance du point $p_i$ � la droite passant par les points $p_1$ et
        $p_n$. Si $c$ est trop grand (sup�rieur � un seuil), alors l'arc est divis� en deux parties
        $\vecteur{p_1}{p_j}$ et $\vecteur{p_j}{p_n}$ o� $p_j$ v�rifie~:
        
                    $$
                    p_j \in \underset{i \in \intervalle{1}{n} }{\arg \max} \;  d\pa{p_i, D\pa{p_1,p_n} } \\
                    $$
                    
        L'arc est ainsi d�coup� jusqu'� ce que plus aucune division ne soit possible.
        
        \end{xalgorithm}


\begin{xremark}{choix de $p_j$}
Dans le pr�c�dent algorithme, $p_j$ est un des points les plus �loign�s de la corde. Si plusieurs points sont � �gale distance de la corde, le point $p_j$ choisi est de pr�f�rence celui qui est le plus au centre de l'arc.
\end{xremark}



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=4cm, width=8cm]
        {\filext{../squelette/image/ske_veccorde}}\end{array}$}$$
        \caption{Vectorisation approch�e d'un arc~: l'arc est divis� en deux parties dont l'extr�mit�
                            commune est le point de l'arc le plus �loign� de sa corde.}
        \label{squelette_vector_corde}
            \end{figure}


\indexfr{composante connexe}

L'article \citeindex{Yeung1996} effectue ce travail dans le cadre de caract�res chinois avec une m�thode diff�rente, les arcs du squelette sont scind�s en plusieurs segments de droites en d�tectant les changements abruptes d'orientation, le d�coupage n'est pas plus conditionn� par des contraintes de distances mais des contraintes angulaires. Comme ce travail s'articule autour de la reconnaissance de caract�res chinois comprenant souvent plusieurs composantes connexes, il propose �galement une m�thode pour connecter les squelettes de deux composantes connexes lorsque certains configurations apparaissent -~par exemple la lettre "T" dont la barre est dissoci�e de son support~-.

Il est possible d'aller plus loin dans la vectorisation du squelette et c'est ce que propose l'article~\citeindex{Chakravarthy2003}. Des points caract�ristiques sont d�tect�s et �tiquet�s le long du squelette. La figure~\ref{squelette_vector_etendu} illustre cette description sous forme de graphe � l'aide des cinq points caract�ristiques parmi douze possibles~:

        \begin{itemize}
        \item A~: (Angle), deux arcs se rejoignent pour former un point de rebroussement.
        \item B~: (Bump), milieu d'un arc courbe.
        \item C~: (Cusp), jonction d'une courbe et d'un segment de droite.
        \item T~: (T point), un segment de droite vient en intercepter un autre en son milieu.
        \item P~: (Peck), un point de rebroussement situ�s au milieu d'un segment de droite.
        \end{itemize}



            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=6cm, width=6cm]
        {\filext{../squelette/image/skevect2}}\end{array}$}$$
        \caption{    Vectorisation �tendue du squelette~: le squelette est vectoris� et chaque arc
                            re�oit une �tiquette choisie (A,B,C,T,P).}
        \label{squelette_vector_etendu}
            \end{figure}


Ces descriptions complexes d'un squelette sous forme de graphe tendent � tirer le plus d'informations possibles de l'image elle-m�me de mani�re � pouvoir, depuis cette structure, identifier la forme repr�sent�e. Cette identification peut �tre effectu�e gr�ce � une distance d'�dition entre graphe, celui obtenu et un mod�le repr�sentant au mieux la forme � identifier. \indexfrr{distance}{�dition}












\subsection{Vectorisation et intersection}
\label{squelette_vectorisation_Abuhaiba1996}
\indexfr{vectorisation}
\indexfr{intersection}
\indexfr{zones d'attraction}

L'article \citeindex{Abuhaiba1996} suppose que lorsque deux traits s'interceptent comme c'est souvent le cas pour une image contenant de l'�criture, la zone de l'intersection est plus �paisse que les zones o� seul un trait appara�t. La figure~\ref{squelette_vector_Abuhaiba1996} illustre ceci dans le cas d'une �toile. Le squelette sans aucun post-traitement contient six points reliant trois branches. A partir d'une estimation de l'�paisseur du trait (voir paragraphe~\ref{image_epaisseur_trace}, page~\pageref{image_epaisseur_trace}), il est possible de d�terminer la zone d'attraction de l'intersection, zone o� la carte des distances contient des valeurs sup�rieures � cette �paisseur.


            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=4cm, width=10cm]
        {\filext{../squelette/image/abus}}\end{array}$}$$
        \caption{    Figure extraite de \citeindexfig{Abuhaiba1996}, l'�paisseur du trait est plus �pais aux intersections,
                            la vectorisation utilise ces zones �tendues pour relier entre eux les arcs du squelette. La premi�re
                            image est l'image originale, la seconde repr�sente le squelette, la troisi�me le squelette 
                            vectoris�.}
        \label{squelette_vector_Abuhaiba1996}
            \end{figure}

Les six points reliant chacun trois branches appartiennent tous � cette zone d'attraction et sont alors consid�r�s comme �tant une seule et m�me intersection. La vectorisation de ce squelette associe donc les huit segments sortant de la zone d'attraction � un seul point de recoupement.


\subsection{Squelette d'une image de texte}

Dans certains cas, certains a priori permettent d'am�liorer la qualit� du r�sultat. C'est le cas de la m�thode d�velopp�e au paragraphe~\ref{dla_squelette}, page~\pageref{dla_squelette} qui tient compte du fait que l'image est celle d'un ou plusieurs mots. L'hypoth�se simplificatrice est dans ce cas une relative homog�n�it� de l'�paisseur de la forme � squelettiser.





\subsection{Appariement squelette - image originale}

\indexfr{appariement}
\indexfr{graph�me}

La segmentation en graph�mes utilise le squelette afin de d�couper l'image d'un mot en lettres ou morceaux de lettres. Il s'agit maintenant de propager ce d�coupage � l'ensemble de l'image, donc de retrouver de quelle partie de la forme initiale un morceau est le squelette. Il est possible d'utiliser la carte de distance d�finie en~\ref{ske_def_cart_dist_def}. Pour chaque pixel noir, le pixel du squelette qui en est le plus proche appara�t en se d�pla�ant dans la carte de distance selon la plus grande pente. Il suffit de r�it�rer ce proc�d� pour chaque pixel � apparier.

Une autre approche permet de r�soudre un probl�me plus g�n�ral. On suppose que l'image contient un ensemble de pixels $\vecteur{p_1}{p_n}$ r�partis en $C$ classes. Chaque pixel $p_i$ est donc �tiquet� par $c_i \in \intervalle{1}{C}$. Pour un pixel $p$ quelconque de l'image, le point le plus proche dans la suite $\vecteur{p_1}{p_n}$ d�termine sa classe. L'algorithme qui suit permet d'effectuer cet �tiquetage de mani�re analogue � l'algorithme~\ref{ske_algo_cart_dist} utilis� pour calculer une carte de distance.

            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=5cm, width=8cm]
        {\filext{../squelette/image/ske_appari}}\end{array}$}$$
        \caption{    Appariement : les fronti�res (gris p�le et fonc�) d�limitent 
                            les zones de pixels (noirs) appari�s au m�me morceau du squelette. }
        \label{squelette_appariement}
            \end{figure}



        \begin{xalgorithm}{appariement}
        \indexfr{appariement}
        \label{ske_algo_appariement}
        
        Soit $P=\vecteur{p_1}{p_n}$ une suite de points, et $\vecteur{c_1}{c_n} \in \intervalle{1}{C}^n$ 
        leurs classes associ�es. On note $D\pa{x,y}$ la distance au point le plus proche de l'ensemble $P$ 
        et $C\pa{x,y}$ la classe de ce point. On impose que $D\pa{x,y} = \infty$ si $\pa{x,y} \notin
        \intervalle{1}{X} \times \intervalle{1}{Y}$.
        
        
        \begin{xalgostep}{premi�re passe d'image}
                \begin{xfor}{y}{1}{Y}
                    \begin{xfor}{x}{1}{X}
                        $
                        \begin{array}{lll}
                        D\pa{x,y} &\longleftarrow& \left\{ \begin{array}{l}
                                                                        0 \text{ si } \exists i \text{ tel que } p_i = \pa{x,y} \\
                                                                        \min  \acc{ D\cro{ \pa{x,y} - v} + M_{v_x,v_y} 
                                                                                \sac v \in V_h\pa{k}} \text{ sinon}
                                                                        \end{array}\right.  \\ \\
                        C\pa{x,y} &\longleftarrow& \left\{ \begin{array}{l}
                                                                        \text{n'est pas d�fini si } D\pa{x,y} = \infty \\
                                                                        c_i \text{ si } \exists i \text{ tel que } p_i = \pa{x,y} \\
                                                                        C\pa{\pa{x,y} - v^*} \\
                                                                        \quad \text{ o� } v^* \in \arg \min  
                                                                        \acc{ D\cro{ \pa{x,y} - v} + M_{v_x,v_y} \sac v \in V_h\pa{k}} 
                                                                                        \text{ sinon}
                                                                        \end{array}\right.
                        \end{array}                                                                
                        $
                    \end{xfor}
                \end{xfor}
        \end{xalgostep}
        
        \begin{xalgostep}{seconde passe d'image}
                \begin{xfor}{y}{Y}{1}
                    \begin{xfor}{x}{X}{1}
                        $
                        \begin{array}{lll}
                        D\pa{x,y} &\longleftarrow&  \min\acc{ D\pa{x,y},  \min  \acc{ D\cro{ \pa{x,y} - v} + M_{v_x,v_y} 
                                                                                    \sac v \in V_b\pa{k}}} \\ \\
                        C\pa{x,y} &\longleftarrow&  C\pa{\pa{x,y} - v^*} \\ 
                                                                                && \quad    \text{ o� } v^* \in \arg \min  
                                                                                    \acc{ D\cro{ \pa{x,y} - v} + M_{v_x,v_y} 
                                                                                    \sac v \in V_b\pa{k} \cup \acc{\pa{0,0}}}
                        \end{array}                                                                
                        $
                    \end{xfor}
                \end{xfor}
        \end{xalgostep}
        
        
        \end{xalgorithm}
        



\begin{xremark}{lien avec le diagramme de Vorono�}
Si pour chaque point $p_i$, $c_i = i$, alors cet algorithme aboutit � la construction de r�gions de "Vorono�" qui serviront � construire le diagramme illustr� dans la figure~\ref{squelette_voronoi}. Le squelette sera constitu� des segments s�parant deux pixels appartenant � des r�gions diff�rentes.\indexfr{Vorono�}
\end{xremark}







\subsection{Construction d'un graphe pour une classification}
\label{squelettisation_graphe_construction}
\indexfrr{squelette}{graphe}
\indexfrr{graphe}{squelette}
\indexfrr{point}{singulier}
\indexfrr{singulier}{point}

L'article \citeindex{Ruberto2004} propose la construction d'un graphe r�sumant le squelette. Les arcs repr�sentent des parties du squelette tandis que les n\oe uds sont ses points singuliers (voir figure~\ref{squelette_point_singuliers}).


            \begin{figure}[ht]
        $$\begin{tabular}{|c|} \hline 
        \includegraphics[height=5cm, width=4cm] {\filext{../squelette/image/sing}} 
        \\ \hline \end{tabular}$$
        \caption{    Ce squelette pr�sente trois points singuliers~: le premier est une extremit�, le second 
                            est la jonction de quatre arcs, le dernier est la jonction de trois arcs.}
        \label{squelette_point_singuliers}
            \end{figure}

\indexfr{reconnaissance}
\indexfr{barbules}

La m�thode d�velopp�e dans cet article utilise un tel graphe qui est d'abord nettoy� des petits arcs ou barbules\seeannex{ske_par_barbule}{barbules}. Il propose ensuite d'associer � chaque arc des caract�ristiques qui sont utilis�es afin d'effectuer une t�che de reconnaissance via le calcul d'une distance entre graphe, celle-ci permettant de comparer le squelette de deux formes entre elles.

Le graphe obtenu contient une liste d'arcs $\vecteur{A_1}{A_n}$, la longueur $l$ du squelette est la somme des longueurs de chaque arcs~: $l = \sum_{i=1}^{n} l\pa{A_i}$. Les arcs $A_i$ dont la longueur v�rifie $l\pa{A_i} < \alpha l$ et ne contenant aucune extr�mit� sont supprim�s puis ajout�s aux arcs auxquels ils sont connect�s. $\alpha$ est choisi �gal � 5\%.

Chaque arc $S$ est ensuite d�crit par six caract�ristiques. $S$ est d�fini par ses deux extr�mit�s $\pa{x_1,y_1}$, $\pa{x_2,y_2}$ et une fonction $t \in \cro{0,1} \longrightarrow \pa{x\pa{t},y\pa{t} }$. Ces six caract�ristiques sont donn�es par la table~\ref{squelette_ruberto_carac}.


            \begin{table}[ht]
            $$\begin{tabular}{|l|l|} \hline
            \begin{tabular}{l} variation de la courbure     \\
                                moyenne, soit les valeurs  \\ extr�mes de la fonction~$c$
                                \end{tabular} & 
                                $v_1=  \underset{t \in \cro{0,1}}{\max} c(t) - 
                                                                     \underset{t \in \cro{0,1}}{\min} c(t)$
                                o� 
                                $ c(t) =  \frac{x'y'' - x''y'}{\pa{ (x')^2 + (y')^2} ^{\frac{3}{2}} } $
                                \\ \hline
            \begin{tabular}{l} l'orientation de l'arc \\ par rapport � celle du squelette    
                                \end{tabular} & 
                                $v_2 = \arctan \frac{ y_2 - y_1 } { x_2 - x_1} $
                                \\ \hline
            \begin{tabular}{l} la taille de l'arc  \\ par rapport � celle du squelette
                                \end{tabular} &
                                $v_3 = \frac{ l(S) } { l }$ 
                                \quad \begin{minipage}{8cm} o� $l(S)$ est la longueur de l'arc 
                                et $l$ longueur du squelette \end{minipage}
                                \\ \hline
            \begin{tabular}{l} la "raideur" de l'arc
                                \end{tabular} & 
                                $v_4 = \frac{ l(S) }{ \sqrt{ \pa{x_2-x_1}^2 + \pa{y_2-y_1}^2 } }$
                                \\ \hline
            \begin{tabular}{l} la variation de l'�paisseur \\ distance le long de l'arc
                                \end{tabular} & 
                                $v_5=  \underset{t \in \cro{0,1}}{\max} e(t) - 
                                                                     \underset{t \in \cro{0,1}}{\min} e(t)$
                                \quad \begin{minipage}{5.8cm} o� $e(t)$ est l'�paisseur de la forme le long de l'arc, 
                                estim�e par exemple � l'aide d'une carte de distance 
                                (voir paragraphe~\ref{ske_carte_distance_sec})
                                \end{minipage}
                                \\ \hline
            \begin{tabular}{l} la taille de la r�gion $R$ \\ par rapport � celle du squelette
                                \end{tabular} & 
                                $v_6 = \frac{ A(S) }{A}$
                                \quad \begin{minipage}{8cm} o� $A(S)$ est la surface de la partie de la forme
                                dont l'arc dont $S$ est le squelette, $A$ est la surface de la forme squelettis�e.
                                \end{minipage}
                                \\ \hline
            \end{tabular}$$
            \caption{ Six caract�ristiques $\vecteur{v_1}{v_6}$ d�crivant un arc extrait du squelette d'une forme, 
                                elles sont extraites de \citeindexfig{Ruberto2004}. 
                                L'arc $S$ est d�fini par ses deux extr�mit�s $\pa{x_1,y_1}$, $\pa{x_2,y_2}$ 
                                et une fonction $t \in \cro{0,1} \longrightarrow \pa{x\pa{t},y\pa{t} }$.}
            \label{squelette_ruberto_carac}
            \indexfrr{�paisseur}{trait}
            \end{table}



\indexfrr{graphe}{attribu�}
\indexfrr{matrice}{adjacence}
\indexfrr{adjacence}{matrice}

L'auteur de l'article \citeindex{Ruberto2004} propose d'utiliser ce graphe "attribu�" afin de calculer une distance entre deux formes pour lesquels ce graphe $G$ aura �t� pr�alablement estim�. Ce graphe inclut un ensemble d'ar�tes d�crites par les caract�ristiques de la table~\ref{squelette_ruberto_carac} et $n$ n\oe uds qui sont les points singuliers du squelette. On d�finit $A = \pa{a_{ij}} _ { 1 \infegal i,j \infegal n } \in \cro{0,1} ^ {n^2}$ la matrice d'adjacence du graphe $G$, le graphe est donc enti�rement d�fini par $G = \acc{ A, \vecteur{v_{i,j,1}}{v_{i,j,6}} \sac 1 \infegal i,j \infegal n}$. La distance entre deux graphes~$G_1$ et~$G_2$ est d�finie par~:


        \begin{eqnarray}
        d\pa{G_1,G_2,\alpha} &=& \inf \acc{ E\pa{G_1,G_,M = \pa{m_{ik}}_ { 
                                                                    \begin{subarray} \,    1 \infegal i \infegal n_1 \\ 
                                                                                                        1 \infegal k \infegal n_2 \end{subarray} }
                                                                                ,\alpha}  \left |
                                                                \begin{array}{l}
                                                                \forall i,k, \, m_{ik} \in \acc{0,1} \\
                                                                \forall k, \, \sum_{i=1}^{n_1} m_{ik} \infegal 1 \\
                                                                \forall i, \, \sum_{k=1}^{n_2} m_{ik} \infegal 1 
                                                                \end{array} \right.
                                                                                } 
                \label{squelettisation_graphe_distance_matching}
                                                                                \\
        \text{ avec }                                                                                
        E\pa{G_1,G_2,M,\alpha} &=& - \frac{1}{2} \; \summy{i=1}{n_1} \; \summy{j=1}{n_1} \; 
                                                                                             \summy{j=1}{n_2} \; \summy{l=1}{n_2} \; 
                                                                                             m_{ik} \, m_{jl} \, e\pa{i \rightarrow j, \, k \rightarrow l} +
                                                                                             \alpha \; \summy{i=1}{n_1} \; \summy{j=1}{n_2} \;
                                                                                             m_{ik} \, e\pa{i,k}
                                \nonumber
        \end{eqnarray}


$\alpha$ est un terme permettant d'ajuster la pr�pond�rance de l'association entre les n\oe uds par rapport � celle entre les ar�tes. La fonction $e\pa{i \rightarrow j, \, k \rightarrow l}$ mesure la vraisemblance de l'association entre l'ar�te $i \rightarrow j$ du premier graphe et l'ar�te $k \rightarrow l$ du second graphe tandis que $e\pa{i,k}$ mesure la vraisemblance de l'association entre le n\oe ud $i$ de premier graphe et le n\oe ud $j$ du second graphe. La premi�re fonction est d�finie comme suit~:


        \begin{eqnarray}
        e\pa{i \rightarrow j, \, k \rightarrow l} &=& \left \{ \begin{array}{ll}
                                            0 & \text{si } a_{ij}^1 a_{kl}^2 = 0 \\
                                            \summy{d=1}{6} L_d \pa{ 1 - \abs{  \frac{v_{i,j,d,1}}{L_d} - \frac{v_{k,l,d,2}}{L_d} }}
                                                    & \text{sinon }
                                            \end{array} \right. \\
        \text{avec } L_d &=&     \frac{1}{2} \, \max \acc{ 
                                                    \summy{i=1}{n_1} \; \summy{j=1}{n_1} \; v_{i,j,d,1}, \;
                                                    \summy{k=1}{n_2} \; \summy{l=1}{n_2} \; v_{k,l,d,2}  }
                \nonumber
        \end{eqnarray}


\indexfr{NP-complet}
\indexfr{affectation gradu�e}

La fonction $e\pa{i,k}$ est construite de mani�re analogue en prenant comme caract�ristique l'�paisseur au point singulier par exemple. Le probl�me de minimisation est malheureusement NP-complet mais il peut �tre r�solu selon une m�thode approch�e appel�e "affection gradu�e" d�velopp�e dans \citeindex{Gold1996}. En d�finitive, la distance~$d$ d�finie en~(\ref{squelettisation_graphe_distance_matching}) permet d'effectuer une classification par plus proches voisins. Etant donn� son co�t �lev�, il est pr�f�rable d'utiliser d'�viter un trop grand nombre de calculs par le biais de m�thodes comme celles d�velopp�es en annexe~\ref{classification_non_supervisee}.






%------------------------------------------------------------------------------------------------------------
\section{Squelette d'un nuage de points}
%------------------------------------------------------------------------------------------------------------
\indexfrr{squelette}{nuage de points}
\label{ske_nuage_point_squelette}

\subsection{Squelettisation � partir d'un treillis de Kohonen}
\indexfrr{Kohonen}{treillis}


Le nettoyage des barbules peut s'av�rer complexe. De plus, la squelettisation par �rosion est souvent sensible aux bruits du contour. C'est pourquoi il est possible de s'inspirer de m�thodes qui permettent de d�terminer le squelette d'un nuage de points. La figure~\ref{squelette_nuage_points} montre la construction du squelette de la lettre "A" la m�thode d�velopp�e par~\citeindex{Datta1997} part d'un squelette dont la topologie est lin�aire. Elle supprime des neurones si ceux-ci sont trop rapproch�s et en ajoute si ceux-ci sont trop �loign�s. Elle cr�e des points "aiguillage" ou barres de "T" lorsque l'angle entre deux segments devient trop ferm�.


            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=12cm, width=6cm]
        {\filext{../squelette/image/nuage}}\end{array}$}$$
        \caption{    Squelette d'un nuage de points : diff�rentes �tapes dans 
                            la construction du squelette de la lettre "A", figure extraite de~\citeindexfig{Datta1997}.}
        \label{squelette_nuage_points}
            \end{figure}



Soit $\vecteur{P_1}{P_N}$ un nuage de points, la topologie initiale est lin�aire et le r�seau est constitu� de $n$ vecteurs (ou neurones) $W = \vecteur{W_1}{W_n}$ o� $W_{i-1}$ et $W_{i+1}$ sont les voisins du vecteur $W_i$. A chaque it�ration~$t$, on tire al�atoirement un point $P_i$ puis on d�termine le vecteur $W^t_{k^*}$ qui en est le plus proche � l'it�ration~$t$~:

             
            \begin{eqnarray*}
            W^t_{k^*} \in \underset {k \in \ensemble {1}{n} } { \arg \min } d \pa{ W_k^t, P_i }
            \end{eqnarray*}


$d \pa{ W_k, P_i }$ est la distance entre $W_k$ et $P_i$. On proc�de ensuite � la mise � jour de $W_{k^*}$ et de l'ensemble de ses voisins not� $N\pa{W_{k^*}}$~:

        
            \begin{eqnarray*}
            \forall k \in N\pa{W_{k^*}}, \; 
                W^{t+1}_k = W^{t}_k + \alpha_t \cro { P_i - W_k }
            \end{eqnarray*}

La suite $\pa{\alpha_t}_{t \supegal 0}$ v�rifie~:

        
            \begin{eqnarray*}
            \summyone{t \supegal 0} \alpha_t = \infty \text { and } \summyone{t \supegal 0} 
                        \alpha_t^2 \infegal \infty
            \end{eqnarray*}
            
Par exemple~:

            $$
            \alpha_t = \frac{\alpha_0}{1+\beta t}
            $$            

L'algorithme s'arr�te lorsque la condition suivante est v�rifi�e~:

            \begin{eqnarray*}
            \forall i \in \ensemble{1}{n}, \; d\pa{W_i^{t+1}, W_i^{t} } \infegal \epsilon
            \end{eqnarray*}

Il reste � g�rer la suppression de deux neurones trop proches, l'insertion d'un neurone entre deux autres trop �loign�s, l'insertion d'un neurone reliant trois voisins ou neurones "T". Ces op�rations sont effectu�es une fois que les �tapes pr�c�dentes ont abouti � une configuration ayant converg�. La suppression d'un neurone est effectu�e si la condition suivante est v�rifi�e~:


            \begin{eqnarray}
            \underset{ i \in \ensemble{1}{n} }     { min }\; \cro{ 
            \underset{ j \in N\pa{W_i} }              { min }\; d\pa{W_i,W_j} } 
                            < \delta_1 
            \label{ske_cloud_point_merge}
            \end{eqnarray}

Dans ce cas, les deux neurones permettant d'atteindre le minimum de (\ref{ske_cloud_point_merge}) sont regroup�s ensemble. L'insertion d'un neurone � deux voisins est effectu�e si la condition suivante est v�rifi�e~:

            \begin{eqnarray}
            \underset{ i \in \ensemble{1}{n} }     { max }\; \cro{ 
            \underset{ j \in N\pa{W_i} }              { max }\; d\pa{W_i,W_j} } 
                            > \delta_2
            \label{ske_cloud_point_insert}
            \end{eqnarray}

Dans ce cas, un neurone est ins�r�e au milieu du segment form� par les deux voisins permettant d'obtenir le maximum de (\ref{ske_cloud_point_insert}). Un neurone "T" � trois voisins est ins�r� lorsque l'angle entre les deux voisins d'un neurone forme un angle ferm�. La figure \ref{squelette_nuage_points}\textit{(b)} montre trois points $X$,$Y$,$Z$. Les droites $(XZ)$ et $(XY)$ forment un angle ferm�, un point � trois voisins est alors ajout� entre les points $Y$ et $Z$.





\subsection{Squelettisation � partir d'un treillis de Kohonen}
\indexfrr{segmentation}{graph�me}
\indexfr{Kohonen}
\indexfr{connexit�}

Cette segmentation s'inspire de l'article~\citeindex{Datta1997} (voir aussi~\citeindex{Singh2000}). Cet article permet de construire le squelette d'un nuage de points. L'ind�pendance par rapport � la connexit� permet d'�tre moins sensible au bruit. Afin de simplifier l'algorithme d�crit dans~\citeindex{Datta1997}, un treillis en deux dimensions est d'abord superpos� � l'image du mot ainsi que le montre la figure~\ref{image_grapheme_kohonen1}.


            \begin{figure}[ht]
        $$\frame{$\begin{array}[c]{c}\includegraphics[height=2cm, width=6cm]
        {\filext{../image/image/cloud_1}}\end{array}$}$$
        \caption{    Treillis de Kohonen initial superpos� au mot � segmenter en graph�mes.}
        \label{image_grapheme_kohonen1}
            \end{figure}

\indexfrr{arbre}{poids minimal}
\indexfr{Kruskal}

Le treillis �volue puis converge vers le r�sultat figure~\ref{image_grapheme_kohonen2}$a$ en utilisant l'algorithme~\ref{reco_algo_carac_kohonen_____}\footnote{
Pour m�moire~:
        \begin{xalgorithm}{caract�ristiques de Kohonen}
        \indexfrr{caract�ristiques}{Kohonen}
        \label{reco_algo_carac_kohonen_____}
        
        \begin{xalgostep}{initialisation}
            $\forall \pa{i,j} \in \ensemble{1}{I} \times \ensemble{1}{J}, \; P_{ij} = \pa{ \frac{iX}{I}, \frac{jY}{J} }'$ \\
            $t \leftarrow 0$ \\
            $\delta  \leftarrow \sqrt{ \pa{\frac{X}{I}}^2 + \pa{\frac{Y}{J}}^2 }$
        \end{xalgostep}
        
        \begin{xalgostep}{point caract�ristique le plus proche et mise � jour} \label{reco_algo_carac_kohonen_conv}
            $\alpha \leftarrow \frac{0.2}{1 + \frac{t}{XY} }$ \\
            On tire al�atoirement un pixel $p$ de l'image, si ce pixel $p$ est noir, alors~:\\
            $\pa{i^*,j^*} \leftarrow \underset{i,j} {\arg \max } \; d\pa{P_{ij}, p}$  \\
            $P_{i^*,j^*}     \leftarrow P_{i^*,j^*} + \alpha \pa{ p - P_{i^*,j^*} }$
        \end{xalgostep}
        
        \begin{xalgostep}{mise � jour des voisins} 
            $\epsilon \leftarrow \exp \pa { \frac{1}{\delta}  \norme{P_{i^*,j^*} - p} - 1} $\\
            \begin{xforeach}{P}{V_c\pa{i^*,j^*}} 
                $\beta     \leftarrow \alpha \, \epsilon \, \exp \pa{ - \frac{1}{\delta} \norme{P  - p} } $ \\
                $P             \leftarrow P + \beta \pa{ p - P}$
            \end{xforeach}
        \end{xalgostep}
        
        \begin{xalgostep}{terminaison}
            $t \leftarrow t+1$ \\
            Tant que l'algorithme n'a pas converg�, retour � l'�tape~\ref{reco_algo_carac_kohonen_conv}.
        \end{xalgostep}
        
        
        \end{xalgorithm}
} d�j� d�crit au paragraphe~\ref{reco_point_caracteristique_kohonen} (page~\pageref{reco_point_caracteristique_kohonen}). Le r�sultat obtenu inclut le squelette recherch� qui sera obtenu en utilisant un algorithme de recherche de l'arbre de poids minimal (voir \citeindex{Kruskal1956}).


            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|} \hline
        \includegraphics[height=2cm, width=6cm]{\filext{../image/image/cloud_2}} &
        \includegraphics[height=2cm, width=6cm]{\filext{../image/image/cloud_3}} \\
        ($a$) & ($b$) \\ \hline
        \end{tabular}$$
        \caption{    La figure ($a$) montre le r�sultat obtenu apr�s convergence de 
                            l'algorithme~\ref{reco_algo_carac_kohonen}. La figure ($b$) montre le m�me arbre 
                            �lagu� apr�s l'application de l'algorithme de Kruskal.}
            \indexfr{Kruskal}
        \label{image_grapheme_kohonen2}
            \end{figure}





\subsection{Squelettisation d'images floues}

\indexfr{r�seau de neurones}
\indexfr{image floue}
\indexfrr{pixel}{intensit�}
\indexfr{intensit�}
\indexfr{niveaux de gris}
\indexfr{�rosion}

L'article \citeindex{Kalm\'ar1999} propose une squelettisation d'images floues bas�e sur un r�seau de neurones. Sa m�thode propose l'�rosion d'une image en niveaux de gris. On suppose que l'image est form�e d'une suite de pixels $\pa{x_i}_i$ et $f\pa{x_i} \in \cro{0,1}$ est l'intensit� du pixel. Les neurones de la premi�re couche sont not�s $\pa{n_i^1}_i$, deux points $p_i, \, a_i \in \mathbb{R}^2$ sont associ�s � chacun de ces neurones, $\pa{a_i}$ est calcul� comme suit~:

            \begin{eqnarray}
            \forall i, \; a_i &=&  \summyone{j} \;   x_j \; f\pa{x_j} \, \exp \cro{ \frac{ - \norme{p_i - x_j}^2} {d_0^2}} 
            \end{eqnarray}

\indexfr{param�tre d'�chelle}
\indexfr{hexagonal}
\indexfrr{voisinage}{hexagonal}

$d_0$ est un param�tre d'�chelle. Les points $p_i$ sont �parpill�s sur l'image et connect�s entre eux selon un syst�me de voisinage qui peut �tre aussi bien carr� (4,~8-connexit�) qu'hexagonal. La connexion entre les neurones $n_i$ et $n_j$ est not�e $w_{ij} \in \cro{0,1}$. A chaque neurone est associ� un param�tre d'activation qui d�pend du temps $\sigma_i\pa{t} \in \cro{0,1}$. $\sigma_i\pa{0}$ est estim� � partir de $a_i$. Par exemple~:


            \begin{eqnarray}
            \sigma_i\pa{0} &=&  f \pa{a_i}
            \end{eqnarray}

L'�volution de $\sigma_i\pa{t}$ est d�finie comme suit~:

            \begin{eqnarray}
            \partialfrac{\sigma_i}{t}\pa{t} &=& \pa{1 - \sigma_i\pa{t} } \pa{
                                                                                        \summyone{k,j} \; w_{ij} \cro{ \sigma_k\pa{t} - \sigma_i \pa{t} } }
            \end{eqnarray}

On d�finit le coefficient $\Sigma_i\pa{t}$ pour chaque neurone~:

            \begin{eqnarray}
             \Sigma_i\pa{t} &=&  \int_0^t \; \summyone{k} \; \cro { \sigma_k\pa{u} - \sigma_i\pa{u} } du
            \end{eqnarray}

            
A partir d'un certain temps $\tau$, la fonction $\Sigma_i\pa{t}$ converge pour tous les neurones et la suite $\pa{\Sigma_i\pa{\tau}}_i$ est alors la distribution du squelette sur l'ensemble des neurones. Cette m�thode peut �galement �tre appliqu�e sur des images binaires mais le r�sultat n'est plus un squelette d'un pixel d'�paisseur un (ou "fil de fer"). En contrepartie, les branches non significatives sont moins probables (voir figure~\ref{image_kalmar_squelette_hexa}).


            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|} \hline
        \includegraphics[height=2cm, width=6cm]{\filext{../squelette/image/kalmar1}} &
        \includegraphics[height=2cm, width=6cm]{\filext{../squelette/image/kalmar2}} \\
        $(a)$ & $(b)$ \\ \hline
        \end{tabular}$$
        \caption{    Figure extraite de \citeindexfig{Kalm\'ar1999}, la forme $(b)$ est amput�e d'un bout dans sa moiti�
                            sup�rieure, les artefacts qui en r�sultent au niveau du squelette sont moins probables que les autres.
                            }
        \label{image_kalmar_squelette_hexa}
            \end{figure}







\subsection{Squelettisation et classification}
\label{squelette_cem_classification}
\indexfrr{classification}{non supervis�e}
\indexfrr{RPCL}{local based PCA}

\indexfr{Competitive EM algorithm}
\indexfrr{algorithme}{EM}

La squelettisation peut �tre �galement trait�e comme une classification non supervis�e. L'article \citeindex{Liu2003} propose une m�thode\seeannex{classification_rpcl_local_pca}{classification} qui consid�re chaque segment de l'image comme une classe suivant une loi normale multidimensionnelle et d�g�n�r�e, la forme de cette classe repr�sente une ellipse dont le petit axe est tr�s inf�rieur au grand axe. L'algorithme RPCL-local based PCA permet � la fois de d�terminer le nombre de segments et d'estimer les param�tres de la loi qui le mod�lise. L'article \citeindex{ZhangB2004} pr�sente un nouvel algorithme EM appel� Competitive~EM\seeannex{classification_CEM}{algorithme CEM} permettant d'�viter les maxima locaux lors de l'optimisation. Le r�sultat obtenu sur des caract�res chinois est pr�sent� par la figure~\ref{image_zhangb_cem}.


            \begin{figure}[ht]
        $$\begin{tabular}{|c|c|c|} \hline
        \includegraphics[height=5cm, width=5cm]{\filext{../squelette/image/zhangs1}} &
        \includegraphics[height=5cm, width=5cm]{\filext{../squelette/image/zhangs2}} &
        \includegraphics[height=5cm, width=5cm]{\filext{../squelette/image/zhangs3}} \\ \hline
        \end{tabular}$$
        \caption{    Figures extraites de \citeindexfig{ZhangB2004} pr�sentant les r�sultats d'une classification
                            effectu�e par l'algorithme Competitive Expectation Maximization (CEM). 
                            La premi�re image repr�sente le caract�re chinois � segmenter.
                            La seconde image illustre les classes obtenues apr�s que l'image a �t� �chantillonn�e 
                            (environ 1500 points). La derni�re traduit chaque classe par un segment �gal 
                            au grand axe de l'ellipse.    }
        \label{image_zhangb_cem}
            \end{figure}
















\newpage


\firstpassagedo{
    \begin{thebibliography}{99}
    \input{squelette_article.tex}
    \end{thebibliography}
}


\input{../../common/livre_table_end.tex}
\input{../../common/livre_end.tex}


